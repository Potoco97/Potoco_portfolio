(()=>{"use strict";var e={367:(e,t,i)=>{var r;i.d(t,{y:()=>r}),function(e){e.caption="caption",e["erase-area"]="erase-area",e.i2i="i2i",e["image-to-video"]="image-to-video",e.inpaint="inpaint",e.instantid="instantid",e.outpaint="outpaint",e.recolor="recolor",e["recommended-image"]="recommended-image",e["remove-bg"]="remove-bg",e["replace-bg"]="replace-bg",e.t2i="t2i",e["text-to-video"]="text-to-video",e.upscale="upscale"}(r||(r={})),Object.values(r).filter((e=>"string"==typeof e))},907:(e,t,i)=>{i.d(t,{CT:()=>h,OW:()=>d,Tn:()=>c});var r,s,n,a=i(381),o=i(430),l=function(e,t,i,r){return new(i||(i=Promise))((function(s,n){function a(e){try{l(r.next(e))}catch(e){n(e)}}function o(e){try{l(r.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,o)}l((r=r.apply(e,t||[])).next())}))},u=function(e,t,i,r){if("a"===i&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?r:"a"===i?r.call(e):r?r.value:t.get(e)};class d{constructor(e){var t;this.interval=2e3,this.currentPollingCount=0,this.isWatching=!1,this.isDestroy=!1,this.watchBeanList=[],this.CLIENT_API=e.CLIENT_API,this.POLLING_API=e.POLLING_API,this.CANCEL_API=e.CANCEL_API,this.POLLING_BODY_KEY=e.POLLING_BODY_KEY,this.CUSTOM_POLLING_INTERVAL=e.CUSTOM_POLLING_INTERVAL,this.CUSTOM_POLLING_INTERVAL_COUNT=null!==(t=e.CUSTOM_POLLING_INTERVAL_COUNT)&&void 0!==t?t:e.CUSTOM_POLLING_INTERVAL&&10}getAuthHeader(e){var t;return(null===(t=null==e?void 0:e.token)||void 0===t?void 0:t.startsWith("Bearer "))?e.token:`Bearer ${e.token}`}isPaidClient(e){return!0===(null==e?void 0:e.paid)}extractEnhancedErrorFromResponse(e){return l(this,void 0,void 0,(function*(){var t,i,r;const s=yield e.text();let n="SERVER_ERROR",o="알 수 없는 서버 오류가 발생했습니다.";try{const a=e.headers.get("Content-Type")||"";if(a.includes("application/json")){const e=JSON.parse(s);n=null!==(t=e.code)&&void 0!==t?t:n,o=null!==(i=e.message)&&void 0!==i?i:o}else if(a.includes("application/xml")||a.includes("text/xml")){const e=(new DOMParser).parseFromString(s,"application/xml"),t=e.querySelector("Code"),i=e.querySelector("Message");t&&i&&(o=null!==(r=i.textContent)&&void 0!==r?r:o)}else o=s}catch(e){}return new a.$W({errorCode:n,message:o})}))}enhancedRequest(e,t,i,s){return l(this,void 0,void 0,(function*(){const n=null!=s?s:new AbortController,{auth:a}=t,o=r.buildFetchOptions(a,Object.assign(Object.assign({},i),{signal:n.signal}));let l=t;if(this.requestAbortController=n,o.method||(o.method="POST"),t instanceof FormData){if(null==a?void 0:a.token)o.headers=Object.assign(Object.assign({},o.headers),{Authorization:this.getAuthHeader(a)});else if(null==a?void 0:a.userId){const{userId:e}=a;t.append("auth",e),this.isPaidClient(a)&&t.append("k",btoa(e))}}else{if(Object.keys(o.headers||{}).some((e=>"content-type"===e.toLowerCase()))||(o.headers=Object.assign(Object.assign({},o.headers),{"Content-Type":"application/json"})),null==a?void 0:a.token)o.headers=Object.assign(Object.assign({},o.headers),{Authorization:this.getAuthHeader(a)});else if(null==a?void 0:a.userId){const{userId:e}=a,i=Object.assign(Object.assign({},t),{auth:e});this.isPaidClient(a)&&(i.k=btoa(e)),l=i}o.body=t instanceof Blob?t:JSON.stringify(l)}const u=yield fetch(e,o),d=u.headers.get("Content-Type"),c=null==d?void 0:d.includes("application/json");if(u.ok)return yield c?u.json():u.text();throw yield this.extractEnhancedErrorFromResponse(u)}))}request(e,t,i){return l(this,void 0,void 0,(function*(){if(this.currentPollingCount=0,!e||!e.userId&&!e.token)throw new a.$W({errorCode:"INVALID_AUTH",message:"인증 정보가 존재하지 않습니다."});const{token:s,userId:n,paid:o}=e,l=new AbortController;this.requestAbortController=l;const u=r.buildFetchOptions(e,{method:"post",signal:l.signal});if(t instanceof FormData)u.body=t,s?u.headers=Object.assign(Object.assign({},u.headers),{Authorization:s.startsWith("Bearer ")?s:`Bearer ${s}`}):n&&(t.append("auth",n),Object.hasOwn(e,"paid")&&!0!==o||t.append("k",btoa(n)));else if(u.headers=Object.assign(Object.assign({},u.headers),{"Content-Type":"application/json"}),s)u.headers=Object.assign(Object.assign({},u.headers),{Authorization:s.startsWith("Bearer ")?s:`Bearer ${s}`}),u.body=JSON.stringify(t);else if(n){const i=Object.assign(Object.assign({},t),{auth:n});Object.hasOwn(e,"paid")&&!0!==o||(i.k=btoa(n)),u.body=JSON.stringify(i)}const d=yield fetch(null!=i?i:this.CLIENT_API,u),c=d.headers.get("X-Trace-Id");if(d.ok)return yield d.json();const h=yield d.text();let p;try{p=JSON.parse(h)}catch(e){}if(null!=p){const e=new Error(p.message);throw e.errorCode=p.code,e.traceId=c,e}const g=new Error(`httpStatusCode: ${d.status}`);throw g.traceId=c,g}))}watch(...e){if(this.currentPollingCount+=1,this.addWatchBeanIfNotExists(e),this.isWatching||this.isDestroy)return;const t=this.watchBeanList.filter((e=>!e.isComplete()));if(0===t.length)return;this.isWatching=!0;const i=this.getPollingInterval(),r="?"+t.map((e=>`id=${e.getId()}`)).join("&");setTimeout((()=>{var e;this.isDestroy||(this.pollingAbortController=new AbortController,fetch(this.POLLING_API+r,{method:"GET",headers:{"Content-Type":"application/json"},signal:null===(e=this.pollingAbortController)||void 0===e?void 0:e.signal}).then((e=>{if(!e.ok)throw Error("통신에러");return e.json()})).then((e=>{t.forEach((t=>{try{t.processWatch(e)}catch(e){}})),this.isWatching=!1,this.watch()})).catch((e=>{this.isWatching=!1,this.watch()})))}),i)}getPollingInterval(){const e=this.CUSTOM_POLLING_INTERVAL&&this.currentPollingCount<=this.CUSTOM_POLLING_INTERVAL_COUNT?this.CUSTOM_POLLING_INTERVAL:this.interval;return null!=e?e:5e3}addWatchBeanIfNotExists(e){if(null!=e)for(const t of e)this.watchBeanList.find((e=>e.getId()===t.getId()))||this.watchBeanList.push(t)}destroy(){return l(this,void 0,void 0,(function*(){var e,t;const i=this.watchBeanList.filter((e=>!e.isComplete()));if(null===(e=this.requestAbortController)||void 0===e||e.abort(),null===(t=this.pollingAbortController)||void 0===t||t.abort(),this.isDestroy=!0,0===i.length)return;const r="?"+i.map((e=>`id=${e.getId()}`)).join("&");return i.forEach((e=>e.cancel())),yield fetch(this.CANCEL_API+r,{method:"put",headers:{"Content-Type":"application/json"}})}))}cancelById(e){const t=this.watchBeanList.find((t=>!t.isComplete()&&t.getId()===e));t&&(t.cancel(),this.watchBeanList=this.watchBeanList.filter((t=>t.getId()!==e)));const i=`?&id=${e}`;fetch(this.CANCEL_API+i,{method:"put",headers:{"Content-Type":"application/json"}}).catch((e=>{}))}static buildFetchOptions(e,t){const i=Object.assign({},t);return null!=e&&(0,o.Pl)(e)?(i.headers=Object.assign(Object.assign({},i.headers),{"X-Client-Lang":u(r,r,"m",s).call(r),"X-Referer-Path":u(r,r,"m",n).call(r)}),i.credentials="include",i):i}}r=d,s=function(){try{return(Array.isArray(navigator.languages)&&navigator.languages.length>0?navigator.languages:[navigator.language||"en"]).join(",")}catch(e){return"en"}},n=function(){try{return window.location.pathname}catch(e){return""}};const c=0,h=1},187:(e,t,i)=>{var r,s;i.d(t,{q:()=>n});const n=new class{constructor(e){this.server=null!=e?e:""}get FILE_PRESIGNED_URL(){return this.server+"/api/pdf/new"}get FILE_ELEMENTS_EXTRACTION(){return this.server+"/api/pdf"}get FILE_ELEMENTS_EXTRACTION_POLLING(){return this.server+"/api/pdf/polling"}get FILE_ELEMENTS_EXTRACTION_CANCEL(){return this.server+"/api/pdf/cancel"}get PRESIGNED_URL(){return this.server+"/api/files/upload-url"}get PRESETS(){return this.server+"/api/presets"}get PRESETS_GROUPBY(){return this.server+"/api/presets/group-by-category"}get PRESETS_CATEGORY_GROUPS(){return this.server+"/api/presets/category-groups"}get PRESETS_CATEGORY_GROUPS_DETAILS(){return this.server+"/api/presets/category-groups/details"}get TEXT_TO_IMAGE(){return this.server+"/api/text-to-image"}get TEXT_TO_IMAGE_CANCEL(){return this.server+"/api/text-to-image/cancel"}get TEXT_TO_IMAGE_POLLING(){return this.server+"/api/text-to-image/polling"}get IMAGE_TO_IMAGE(){return this.server+"/api/image-to-image"}get IMAGE_TO_IMAGE_CANCEL(){return this.server+"/api/image-to-image/cancel"}get IMAGE_TO_IMAGE_POLLING(){return this.server+"/api/image-to-image/polling"}get IMAGE_GENERATE_REQUESTS_COUNT(){return this.server+"/api/image-generate/requests/count"}get IMAGE_GENERATE_REQUESTS_COUNT_CLEAR(){return this.server+"/api/image-generate/requests/count/clear"}get ERASE_AREA(){return this.server+"/api/erase-area"}get ERASE_AREA_POLLING(){return this.server+"/api/erase-area/polling"}get ERASE_AREA_CANCEL(){return this.server+"/api/erase-area/cancel"}get UPSCALE(){return this.server+"/api/upscale"}get UPSCALE_POLLING(){return this.server+"/api/upscale/polling"}get UPSCALE_CANCEL(){return this.server+"/api/upscale/cancel"}get REMOVE_BACKGROUND(){return this.server+"/api/remove-background"}get REMOVE_BACKGROUND_POLLING(){return this.server+"/api/remove-background/polling"}get REMOVE_BACKGROUND_CANCEL(){return this.server+"/api/remove-background/cancel"}get RECOLOR(){return this.server+"/api/recolor"}get RECOLOR_POLLING(){return this.server+"/api/recolor/polling"}get RECOLOR_CANCEL(){return this.server+"/api/recolor/cancel"}get RECOMMENDED_IMAGE(){return this.server+"/api/recommended-image"}get RECOMMENDED_IMAGE_POLLING(){return this.server+"/api/recommended-image/polling"}get RECOMMENDED_IMAGE_CANCEL(){return this.server+"/api/recommended-image/cancel"}get INPAINT(){return this.server+"/api/inpaint"}get INPAINT_POLLING(){return this.server+"/api/inpaint/polling"}get INPAINT_CANCEL(){return this.server+"/api/inpaint/cancel"}get REPLACE_BACKGROUND(){return this.server+"/api/replace-background"}get REPLACE_BACKGROUND_POLLING(){return this.server+"/api/replace-background/polling"}get REPLACE_BACKGROUND_CANCEL(){return this.server+"/api/replace-background/cancel"}get OUTPAINT(){return this.server+"/api/outpaint"}get OUTPAINT_POLLING(){return this.server+"/api/outpaint/polling"}get OUTPAINT_CANCEL(){return this.server+"/api/outpaint/cancel"}get INSTANTID(){return this.server+"/api/instantid"}get INSTANTID_POLLING(){return this.server+"/api/instantid/polling"}get INSTANTID_CANCEL(){return this.server+"/api/instantid/cancel"}get TEXT_TO_VIDEO(){return this.server+"/api/text-to-video"}get TEXT_TO_VIDEO_POLLING(){return this.server+"/api/text-to-video/polling"}get TEXT_TO_VIDEO_CANCEL(){return this.server+"/api/text-to-video/cancel"}get IMAGE_TO_VIDEO(){return this.server+"/api/image-to-video"}get IMAGE_TO_VIDEO_POLLING(){return this.server+"/api/image-to-video/polling"}get IMAGE_TO_VIDEO_CANCEL(){return this.server+"/api/image-to-video/cancel"}get CREDIT_STATUS(){return this.server+"/api/credits"}get CREDIT_CLEAR(){return this.server+"/api/credits/clear"}get EASY_EDIT_CREDIT_DEDUCTIONS(){return this.server+"/api/credits/deductions/easy-edit"}get IMAGE_GENERATED_SCORE(){return this.server+"/api/generated-image-score"}get ERROR_LOGS(){return this.server+"/api/simple-logs"}}(null!==(s=null===(r=window.__CPDEVK_AITOOLS__)||void 0===r?void 0:r.API_SERVER)&&void 0!==s?s:"https://aicreation.miricanvas.com")},171:(e,t,i)=>{i.d(t,{b:()=>n,n:()=>s});var r=i(381);const s=e=>e instanceof r.$W&&Object.values(n).includes(e.errorCode),n={INVALID_FILE:"INVALID_FILE",INVALID_AUTH:"INVALID_AUTH",INVALID_SERVICE_TYPE:"INVALID_SERVICE_TYPE",UPLOAD_FAIL:"UPLOAD_FAIL",SERVER_ERROR:"SERVER_ERROR",MISSING_PARAMETER:"MISSING_PARAMETER",INVALID_PARAMETER:"INVALID_PARAMETER"}},381:(e,t,i)=>{i.d(t,{$W:()=>r,B_:()=>s});class r extends Error{constructor({errorCode:e,message:t,source:i}){super(t),this.errorCode=e,this.message=t,this.source=i,Error.captureStackTrace&&Error.captureStackTrace(this,r)}}function s(e){return function(e){return e instanceof Error&&Object.hasOwn(e,"traceId")&&"string"==typeof e.traceId}(e)?e.traceId:null}},430:(e,t,i)=>{i.d(t,{Pl:()=>s,cY:()=>r});class r{constructor(){this._resolve=void 0,this._reject=void 0,this.promise=new Promise(((e,t)=>{this._resolve=e,this._reject=t})),this.status="PENDING",this.revision=0}resolve(e){this.revision++,this.status="RESOLVED",this._resolve(e)}reject(e){this.revision++,this.status="REJECT",this._reject(e)}isResolved(){return"RESOLVED"===this.status}isPending(){return"PENDING"===this.status}}function s(e){return"object"==typeof e&&null!==e&&Object.getPrototypeOf(e)===Object.prototype}}},t={};function i(r){var s=t[r];if(void 0!==s)return s.exports;var n=t[r]={exports:{}};return e[r](n,n.exports,i),n.exports}i.d=(e,t)=>{for(var r in t)i.o(t,r)&&!i.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var r,s=i(907),n=i(187);!function(e){e.en="en",e.ja="ja",e.ko="ko"}(r||(r={}));const a=Object.values(r).filter((e=>"string"==typeof e));var o;!function(e){e.INPAINT_MASKED="INPAINT_MASKED",e.INPAINT_NOT_MASKED="INPAINT_NOT_MASKED"}(o||(o={})),Object.values(o).filter((e=>"string"==typeof e));var l,u=i(430),d=i(367);!function(e){e.BACKOFFICE="BACKOFFICE",e.GALLERY="GALLERY",e.TASK_RESULT="TASK_RESULT"}(l||(l={})),Object.values(l).filter((e=>"string"==typeof e));var c,h,p,g,m,f=function(e,t,i,r){if("a"===i&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?r:"a"===i?r.call(e):r?r.value:t.get(e)};class v{constructor(e){c.add(this),this.uuid=e.uuid,this.taskSize=e.taskSize,this.taskResultList=[],this.isCompleteLazyValidation=!1,this.isErrorLazyValidation=!1,this.credit=e.credit,this.successHandler=e.successHandler,this.errorHandler=e.errorHandler,this.deferred=e.deferred}getId(){return this.uuid}isValidateComplete(){return this.isCompleteLazyValidation}isComplete(){if(this.isErrorLazyValidation)return!0;if(0===this.taskResultList.length)return!1;for(let e=0;e<this.taskSize;e++)if(null==this.taskResultList[e])return!1;return!0}cancel(){for(let e=0;e<this.taskSize;e++)null==this.taskResultList[e]&&(this.taskResultList[e]={imageGenerateOrder:-100,result:null})}processWatch(e){var t,i,r,s;const n=e.list.find((e=>e.uuid===this.uuid));if(n){if(n.info.hasError){if(!this.isCompleteLazyValidation){const e=new Error("금지어 포함됨: [?]");return e.errorCode="PROHIBITED_WORD",null===(t=this.deferred)||void 0===t||t.reject(e),void(this.isErrorLazyValidation=!0)}this.isErrorLazyValidation=!0}if(0!==n.taskList.length){if(!this.isCompleteLazyValidation&&n.info.validated&&n.taskList.length>0){f(this,c,"m",h).call(this,n);const e={uuid:this.uuid,taskSize:this.taskSize,credit:Object.assign(Object.assign({},this.credit),{isFreeCreditClient:(null!==(r=null===(i=this.credit)||void 0===i?void 0:i.remainFreeRequestCount)&&void 0!==r?r:0)>0})};null===(s=this.deferred)||void 0===s||s.resolve(e)}n.taskList.forEach((e=>{try{f(this,c,"m",p).call(this,e)}catch(t){console.log(`${this.uuid} ${e.imageGenerateOrder} 처리중 오류`,e),console.error(t)}}))}}}}c=new WeakSet,h=function(e){this.isCompleteLazyValidation=!0,this.taskSize=e.taskList.length},p=function(e){var t,i,r;this.taskResultList[e.imageGenerateOrder]||(0===this.taskSize&&this.taskResultList.length>0&&(this.taskSize=this.taskResultList.length),(null===(t=e.result)||void 0===t?void 0:t.url)?f(this,c,"m",g).call(this,e):((null===(i=e.result)||void 0===i?void 0:i.hasError)||(null===(r=e.result)||void 0===r?void 0:r.isCancel))&&f(this,c,"m",m).call(this,e))},g=function(e){this.taskResultList[e.imageGenerateOrder]=e,setTimeout((()=>{var t,i;e.result.backgroundRemovedUrl?null===(t=this.successHandler)||void 0===t||t.call(this,{imageGenerateOrder:e.imageGenerateOrder,imageUrl:e.result.url,backgroundRemovedUrl:e.result.backgroundRemovedUrl}):null===(i=this.successHandler)||void 0===i||i.call(this,{imageGenerateOrder:e.imageGenerateOrder,imageUrl:e.result.url})}),0)},m=function(e){this.taskResultList[e.imageGenerateOrder]=e,setTimeout((()=>{var t;null===(t=this.errorHandler)||void 0===t||t.call(this,{imageGenerateOrder:e.imageGenerateOrder,error:"unknown"})}),0)};var L,I,E,O=function(e,t,i,r){if("a"===i&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?r:"a"===i?r.call(e):r?r.value:t.get(e)};class y{constructor(e){L.add(this),this.taskSize=1,this.uuid=e.uuid,this.credit=e.credit,this.successHandler=e.successHandler,this.errorHandler=e.errorHandler,this.deferred=e.deferred}cancel(){this.taskResult&&null==this.taskResult.result&&(this.taskResult.result={hasError:!0,filesize:0,isCancel:!1})}getId(){return this.uuid}isComplete(){return null!=this.taskResult&&null!=this.taskResult.result}isValidateComplete(){return!0}processWatch(e){var t,i,r;const n=e.list.find((e=>e.uuid===this.uuid));if(n&&(null==this.taskResult&&(this.taskResult=n.task,null===(t=this.deferred)||void 0===t||t.resolve({uuid:this.uuid,taskSize:s.CT,credit:Object.assign(Object.assign({},this.credit),{isFreeCreditClient:(null!==(r=null===(i=this.credit)||void 0===i?void 0:i.remainFreeRequestCount)&&void 0!==r?r:0)>0})})),null!=n.task.result&&(this.taskResult.result=n.task.result),null!=this.taskResult.result)){const{url:e,hasError:t,isCancel:i}=this.taskResult.result,r=s.Tn;e?O(this,L,"m",I).call(this,{imageGenerateOrder:r,imageUrl:e}):(t||i)&&O(this,L,"m",E).call(this,{imageGenerateOrder:r,error:"unknown"})}}}L=new WeakSet,I=function(e){setTimeout((()=>{var t;null===(t=this.successHandler)||void 0===t||t.call(this,e)}),0)},E=function(e){setTimeout((()=>{var t;null===(t=this.errorHandler)||void 0===t||t.call(this,e)}),0)};var C,_,w,T=function(e,t,i,r){if("a"===i&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?r:"a"===i?r.call(e):r?r.value:t.get(e)};class R{constructor(e){C.add(this),this.taskSize=1,this.uuid=e.uuid,this.credit=e.credit,this.successHandler=e.successHandler,this.errorHandler=e.errorHandler,this.deferred=e.deferred}cancel(){this.taskResult&&null==this.taskResult.result&&(this.taskResult.result={hasError:!0,filesize:0,outputImageHeight:0,outputImageWidth:0,isCancel:!1})}getId(){return this.uuid}isComplete(){return null!=this.taskResult&&null!=this.taskResult.result}isValidateComplete(){return!0}processWatch(e){var t,i,r;const n=e.list.find((e=>e.uuid===this.uuid));if(n&&(null==this.taskResult&&(this.taskResult=n.task,null===(t=this.deferred)||void 0===t||t.resolve({uuid:this.uuid,taskSize:s.CT,credit:Object.assign(Object.assign({},this.credit),{isFreeCreditClient:(null!==(r=null===(i=this.credit)||void 0===i?void 0:i.remainFreeRequestCount)&&void 0!==r?r:0)>0})})),null!=n.task.result&&(this.taskResult.result=n.task.result),null!=this.taskResult.result)){const{url:e,hasError:t,isCancel:i}=this.taskResult.result,r=s.Tn;e?T(this,C,"m",_).call(this,{imageGenerateOrder:r,imageUrl:e}):(t||i)&&T(this,C,"m",w).call(this,{imageGenerateOrder:r,error:"unknown"})}}}C=new WeakSet,_=function(e){setTimeout((()=>{var t;null===(t=this.successHandler)||void 0===t||t.call(this,e)}),0)},w=function(e){setTimeout((()=>{var t;null===(t=this.errorHandler)||void 0===t||t.call(this,e)}),0)};var k,A,N,P=function(e,t,i,r){if("a"===i&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?r:"a"===i?r.call(e):r?r.value:t.get(e)};class S{constructor(e){k.add(this),this.taskSize=1,this.uuid=e.uuid,this.credit=e.credit,this.successHandler=e.successHandler,this.errorHandler=e.errorHandler,this.deferred=e.deferred}cancel(){this.taskResult&&null==this.taskResult.result&&(this.taskResult.result={hasError:!0,filesize:0,isCancel:!1})}getId(){return this.uuid}isComplete(){return null!=this.taskResult&&null!=this.taskResult.result}isValidateComplete(){return!0}processWatch(e){var t,i,r;const n=e.list.find((e=>e.uuid===this.uuid));if(n&&(null==this.taskResult&&(this.taskResult=n.task,null===(t=this.deferred)||void 0===t||t.resolve({uuid:this.uuid,taskSize:s.CT,credit:Object.assign(Object.assign({},this.credit),{isFreeCreditClient:(null!==(r=null===(i=this.credit)||void 0===i?void 0:i.remainFreeRequestCount)&&void 0!==r?r:0)>0})})),null!=n.task.result&&(this.taskResult.result=n.task.result),null!=this.taskResult.result)){const{url:e,hasError:t,isCancel:i}=this.taskResult.result,r=s.Tn;e?P(this,k,"m",A).call(this,{imageGenerateOrder:r,imageUrl:e}):(t||i)&&P(this,k,"m",N).call(this,{imageGenerateOrder:r,error:"unknown"})}}}k=new WeakSet,A=function(e){setTimeout((()=>{var t;null===(t=this.successHandler)||void 0===t||t.call(this,e)}),0)},N=function(e){setTimeout((()=>{var t;null===(t=this.errorHandler)||void 0===t||t.call(this,e)}),0)};var G,b,U,D,M,V=function(e,t,i,r){if("a"===i&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?r:"a"===i?r.call(e):r?r.value:t.get(e)};class j{constructor(e){G.add(this),this.uuid=e.uuid,this.taskSize=e.taskSize,this.taskResultList=[],this.isCompleteLazyValidation=!1,this.isErrorLazyValidation=!1,this.credit=e.credit,this.successHandler=e.successHandler,this.errorHandler=e.errorHandler,this.deferred=e.deferred}getId(){return this.uuid}isValidateComplete(){return this.isCompleteLazyValidation}isComplete(){if(this.isErrorLazyValidation)return!0;if(0===this.taskResultList.length)return!1;for(let e=0;e<this.taskSize;e++)if(null==this.taskResultList[e])return!1;return!0}cancel(){for(let e=0;e<this.taskSize;e++)null==this.taskResultList[e]&&(this.taskResultList[e]={imageGenerateOrder:-100})}processWatch(e){var t,i,r,s;const n=e.list.find((e=>e.uuid===this.uuid));if(n){if(n.info.hasError){if(!this.isCompleteLazyValidation){const e=new Error("금지어 포함됨: [?]");return e.errorCode="PROHIBITED_WORD",null===(t=this.deferred)||void 0===t||t.reject(e),void(this.isErrorLazyValidation=!0)}this.isErrorLazyValidation=!0}if(0!==n.taskList.length){if(!this.isCompleteLazyValidation&&n.info.validated&&n.taskList.length>0){V(this,G,"m",b).call(this,n);const e={uuid:this.uuid,taskSize:this.taskSize,credit:Object.assign(Object.assign({},this.credit),{isFreeCreditClient:(null!==(r=null===(i=this.credit)||void 0===i?void 0:i.remainFreeRequestCount)&&void 0!==r?r:0)>0})};null===(s=this.deferred)||void 0===s||s.resolve(e)}n.taskList.forEach((e=>{try{V(this,G,"m",U).call(this,e)}catch(t){console.log(`${this.uuid} ${e.imageGenerateOrder} 처리중 오류`,e),console.error(t)}}))}}}}G=new WeakSet,b=function(e){this.isCompleteLazyValidation=!0,this.taskSize=e.taskList.length},U=function(e){var t;if(this.taskResultList[e.imageGenerateOrder])return;0===this.taskSize&&this.taskResultList.length>0&&(this.taskSize=this.taskResultList.length);const{url:i,hasError:r,isCancel:s}=null!==(t=e.result)&&void 0!==t?t:{};i?V(this,G,"m",D).call(this,e):(r||s)&&V(this,G,"m",M).call(this,e)},D=function(e){this.taskResultList[e.imageGenerateOrder]=e,setTimeout((()=>{var t,i,r,s,n,a,o,l;(null===(t=e.result)||void 0===t?void 0:t.backgroundRemovedUrl)?null===(i=this.successHandler)||void 0===i||i.call(this,{imageGenerateOrder:e.imageGenerateOrder,imageUrl:null!==(s=null===(r=e.result)||void 0===r?void 0:r.url)&&void 0!==s?s:"",backgroundRemovedUrl:null===(n=e.result)||void 0===n?void 0:n.backgroundRemovedUrl}):null===(a=this.successHandler)||void 0===a||a.call(this,{imageGenerateOrder:e.imageGenerateOrder,imageUrl:null!==(l=null===(o=e.result)||void 0===o?void 0:o.url)&&void 0!==l?l:""})}),0)},M=function(e){this.taskResultList[e.imageGenerateOrder]=e,setTimeout((()=>{var t;null===(t=this.errorHandler)||void 0===t||t.call(this,{imageGenerateOrder:e.imageGenerateOrder,error:"unknown"})}),0)};var z,F,K,W,H,$=function(e,t,i,r){if("a"===i&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?r:"a"===i?r.call(e):r?r.value:t.get(e)};class q{constructor(e){z.add(this),this.uuid=e.uuid,this.taskSize=e.taskSize,this.taskResultList=[],this.isCompleteLazyValidation=!1,this.isErrorLazyValidation=!1,this.credit=e.credit,this.successHandler=e.successHandler,this.errorHandler=e.errorHandler,this.deferred=e.deferred}getId(){return this.uuid}isValidateComplete(){return this.isCompleteLazyValidation}isComplete(){if(this.isErrorLazyValidation)return!0;if(0===this.taskResultList.length)return!1;for(let e=0;e<this.taskSize;e++)if(null==this.taskResultList[e])return!1;return!0}cancel(){for(let e=0;e<this.taskSize;e++)null==this.taskResultList[e]&&(this.taskResultList[e]={imageGenerateOrder:-100,result:null})}processWatch(e){var t,i,r,s;const n=e.list.find((e=>e.uuid===this.uuid));if(n){if(n.info.hasError){if(!this.isCompleteLazyValidation){const e=new Error("금지어 포함됨: [?]");return e.errorCode="PROHIBITED_WORD",null===(t=this.deferred)||void 0===t||t.reject(e),void(this.isErrorLazyValidation=!0)}this.isErrorLazyValidation=!0}if(0!==n.taskList.length){if(!this.isCompleteLazyValidation&&n.info.validated&&n.taskList.length>0){$(this,z,"m",F).call(this,n);const e={uuid:this.uuid,taskSize:this.taskSize,credit:Object.assign(Object.assign({},this.credit),{isFreeCreditClient:(null!==(r=null===(i=this.credit)||void 0===i?void 0:i.remainFreeRequestCount)&&void 0!==r?r:0)>0})};null===(s=this.deferred)||void 0===s||s.resolve(e)}n.taskList.forEach((e=>{try{$(this,z,"m",K).call(this,e)}catch(t){console.log(`${this.uuid} ${e.imageGenerateOrder} 처리중 오류`,e),console.error(t)}}))}}}}z=new WeakSet,F=function(e){this.isCompleteLazyValidation=!0,this.taskSize=e.taskList.length},K=function(e){var t,i,r;this.taskResultList[e.imageGenerateOrder]||(0===this.taskSize&&this.taskResultList.length>0&&(this.taskSize=this.taskResultList.length),(null===(t=e.result)||void 0===t?void 0:t.url)?$(this,z,"m",W).call(this,e):((null===(i=e.result)||void 0===i?void 0:i.hasError)||(null===(r=e.result)||void 0===r?void 0:r.isCancel))&&$(this,z,"m",H).call(this,e))},W=function(e){this.taskResultList[e.imageGenerateOrder]=e,setTimeout((()=>{var t,i,r,s,n,a,o,l;(null===(t=e.result)||void 0===t?void 0:t.backgroundRemovedUrl)?null===(i=this.successHandler)||void 0===i||i.call(this,{imageGenerateOrder:e.imageGenerateOrder,imageUrl:null!==(r=e.result.url)&&void 0!==r?r:"",thumbnailUrl:null!==(s=e.result.cropImageUrl)&&void 0!==s?s:"",backgroundRemovedUrl:e.result.backgroundRemovedUrl}):null===(n=this.successHandler)||void 0===n||n.call(this,{imageGenerateOrder:e.imageGenerateOrder,imageUrl:null!==(a=e.result.url)&&void 0!==a?a:"",thumbnailUrl:null!==(l=null===(o=e.result)||void 0===o?void 0:o.cropImageUrl)&&void 0!==l?l:""})}),0)},H=function(e){this.taskResultList[e.imageGenerateOrder]=e,setTimeout((()=>{var t;null===(t=this.errorHandler)||void 0===t||t.call(this,{imageGenerateOrder:e.imageGenerateOrder,error:"unknown"})}),0)};var B,x,Y,X,J,Q=function(e,t,i,r){if("a"===i&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?r:"a"===i?r.call(e):r?r.value:t.get(e)};class Z{constructor(e){B.add(this),this.uuid=e.uuid,this.taskSize=e.taskSize,this.taskResultList=[],this.isCompleteLazyValidation=!1,this.isErrorLazyValidation=!1,this.credit=e.credit,this.successHandler=e.successHandler,this.errorHandler=e.errorHandler,this.deferred=e.deferred}getId(){return this.uuid}isValidateComplete(){return this.isCompleteLazyValidation}isComplete(){if(this.isErrorLazyValidation)return!0;if(0===this.taskResultList.length)return!1;for(let e=0;e<this.taskSize;e++)if(null==this.taskResultList[e])return!1;return!0}cancel(){for(let e=0;e<this.taskSize;e++)null==this.taskResultList[e]&&(this.taskResultList[e]={imageGenerateOrder:-100})}processWatch(e){var t,i,r,s;const n=e.list.find((e=>e.uuid===this.uuid));if(n){if(n.info.hasError){if(!this.isCompleteLazyValidation){const e=new Error("금지어 포함됨: [?]");return e.errorCode="PROHIBITED_WORD",null===(t=this.deferred)||void 0===t||t.reject(e),void(this.isErrorLazyValidation=!0)}this.isErrorLazyValidation=!0}if(0!==n.taskList.length){if(!this.isCompleteLazyValidation&&n.info.validated&&n.taskList.length>0){Q(this,B,"m",x).call(this,n);const e={uuid:this.uuid,taskSize:this.taskSize,credit:Object.assign(Object.assign({},this.credit),{isFreeCreditClient:(null!==(r=null===(i=this.credit)||void 0===i?void 0:i.remainFreeRequestCount)&&void 0!==r?r:0)>0})};null===(s=this.deferred)||void 0===s||s.resolve(e)}n.taskList.forEach((e=>{try{Q(this,B,"m",Y).call(this,e)}catch(t){console.log(`${this.uuid} ${e.imageGenerateOrder} 처리중 오류`,e),console.error(t)}}))}}}}B=new WeakSet,x=function(e){this.isCompleteLazyValidation=!0,this.taskSize=e.taskList.length},Y=function(e){var t,i,r;this.taskResultList[e.imageGenerateOrder]||(0===this.taskSize&&this.taskResultList.length>0&&(this.taskSize=this.taskResultList.length),(null===(t=e.result)||void 0===t?void 0:t.url)?Q(this,B,"m",X).call(this,e):((null===(i=e.result)||void 0===i?void 0:i.hasError)||(null===(r=e.result)||void 0===r?void 0:r.isCancel))&&Q(this,B,"m",J).call(this,e))},X=function(e){this.taskResultList[e.imageGenerateOrder]=e,setTimeout((()=>{var t;null===(t=this.successHandler)||void 0===t||t.call(this,{imageGenerateOrder:e.imageGenerateOrder,imageUrl:e.result.url})}),0)},J=function(e){this.taskResultList[e.imageGenerateOrder]=e,setTimeout((()=>{var t;null===(t=this.errorHandler)||void 0===t||t.call(this,{imageGenerateOrder:e.imageGenerateOrder,error:"unknown"})}),0)};var ee,te,ie,re,se,ne=function(e,t,i,r){if("a"===i&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?r:"a"===i?r.call(e):r?r.value:t.get(e)};class ae{constructor(e){ee.add(this),this.uuid=e.uuid,this.taskSize=e.taskSize,this.taskResultList=[],this.isCompleteLazyValidation=!1,this.isErrorLazyValidation=!1,this.credit=e.credit,this.successHandler=e.successHandler,this.errorHandler=e.errorHandler,this.deferred=e.deferred}getId(){return this.uuid}isValidateComplete(){return this.isCompleteLazyValidation}isComplete(){if(this.isErrorLazyValidation)return!0;if(0===this.taskResultList.length)return!1;for(let e=0;e<this.taskSize;e++)if(!this.taskResultList[e]&&null==this.taskResultList[e])return!1;return!0}cancel(){for(let e=0;e<this.taskSize;e++)null==this.taskResultList[e]&&(this.taskResultList[e]={imageGenerateOrder:-100,result:null})}processWatch(e){var t,i,r;const s=e.list.find((e=>e.uuid===this.uuid));if(s&&0!==s.taskList.length){if(s.taskList.length>0){ne(this,ee,"m",te).call(this,s);const e={uuid:this.uuid,taskSize:this.taskSize,credit:Object.assign(Object.assign({},this.credit),{isFreeCreditClient:(null!==(i=null===(t=this.credit)||void 0===t?void 0:t.remainFreeRequestCount)&&void 0!==i?i:0)>0})};null===(r=this.deferred)||void 0===r||r.resolve(e)}s.taskList.forEach((e=>{try{ne(this,ee,"m",ie).call(this,e)}catch(t){console.log(`${this.uuid} ${e.imageGenerateOrder} 처리중 오류`,e),console.error(t)}}))}}}ee=new WeakSet,te=function(e){this.taskSize=e.taskList.length},ie=function(e){var t,i,r;this.taskResultList[e.imageGenerateOrder]||(0===this.taskSize&&this.taskResultList.length>0&&(this.taskSize=this.taskResultList.length),(null===(t=e.result)||void 0===t?void 0:t.url)?ne(this,ee,"m",re).call(this,e):((null===(i=e.result)||void 0===i?void 0:i.hasError)||(null===(r=e.result)||void 0===r?void 0:r.isCancel))&&ne(this,ee,"m",se).call(this,e))},re=function(e){this.taskResultList[e.imageGenerateOrder]=e,setTimeout((()=>{this.taskResultList[e.imageGenerateOrder]=e,setTimeout((()=>{var t,i;null===(t=this.successHandler)||void 0===t||t.call(this,{imageGenerateOrder:e.imageGenerateOrder,imageUrl:null!==(i=e.result.url)&&void 0!==i?i:""})}),0)}),0)},se=function(e){this.taskResultList[e.imageGenerateOrder]=e,setTimeout((()=>{var t;null===(t=this.errorHandler)||void 0===t||t.call(this,{imageGenerateOrder:e.imageGenerateOrder,error:"unknown"})}),0)};var oe=i(381),le=function(e,t,i,r){return new(i||(i=Promise))((function(s,n){function a(e){try{l(r.next(e))}catch(e){n(e)}}function o(e){try{l(r.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,o)}l((r=r.apply(e,t||[])).next())}))};const ue="outpaint-free",de=100;var ce,he,pe,ge,me,fe=function(e,t,i,r){if("a"===i&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?r:"a"===i?r.call(e):r?r.value:t.get(e)};class ve{constructor(e){ce.add(this),this.uuid=e.uuid,this.taskSize=e.taskSize,this.taskResultList=[],this.isCompleteLazyValidation=!1,this.isErrorLazyValidation=!1,this.credit=e.credit,this.successHandler=e.successHandler,this.errorHandler=e.errorHandler,this.deferred=e.deferred}getId(){return this.uuid}isValidateComplete(){return this.isCompleteLazyValidation}isComplete(){if(this.isErrorLazyValidation)return!0;if(0===this.taskResultList.length)return!1;for(let e=0;e<this.taskSize;e++)if(null==this.taskResultList[e])return!1;return!0}cancel(){for(let e=0;e<this.taskSize;e++)null==this.taskResultList[e]&&(this.taskResultList[e]={imageGenerateOrder:-100,result:null})}processWatch(e){var t,i,r,s;const n=e.list.find((e=>e.uuid===this.uuid));if(n){if(n.info.hasError){if(!this.isCompleteLazyValidation){const e=new Error("금지어 포함됨: [?]");return e.errorCode="PROHIBITED_WORD",null===(t=this.deferred)||void 0===t||t.reject(e),void(this.isErrorLazyValidation=!0)}this.isErrorLazyValidation=!0}if(0!==n.taskList.length){if(!this.isCompleteLazyValidation&&n.info.validated&&n.taskList.length>0){fe(this,ce,"m",he).call(this,n);const e={uuid:this.uuid,taskSize:this.taskSize,credit:Object.assign(Object.assign({},this.credit),{isFreeCreditClient:(null!==(r=null===(i=this.credit)||void 0===i?void 0:i.remainFreeRequestCount)&&void 0!==r?r:0)>0})};null===(s=this.deferred)||void 0===s||s.resolve(e)}n.taskList.forEach((e=>{try{fe(this,ce,"m",pe).call(this,e)}catch(t){console.log(`${this.uuid} ${e.imageGenerateOrder} 처리중 오류`,e),console.error(t)}}))}}}}ce=new WeakSet,he=function(e){this.isCompleteLazyValidation=!0,this.taskSize=e.taskList.length},pe=function(e){var t,i,r;this.taskResultList[e.imageGenerateOrder]||(0===this.taskSize&&this.taskResultList.length>0&&(this.taskSize=this.taskResultList.length),(null===(t=e.result)||void 0===t?void 0:t.url)?fe(this,ce,"m",ge).call(this,e):((null===(i=e.result)||void 0===i?void 0:i.hasError)||(null===(r=e.result)||void 0===r?void 0:r.isCancel))&&fe(this,ce,"m",me).call(this,e))},ge=function(e){this.taskResultList[e.imageGenerateOrder]=e,setTimeout((()=>{var t,i,r,s,n;(null===(t=e.result)||void 0===t?void 0:t.backgroundRemovedUrl)?null===(i=this.successHandler)||void 0===i||i.call(this,{imageGenerateOrder:e.imageGenerateOrder,imageUrl:null!==(r=e.result.url)&&void 0!==r?r:"",backgroundRemovedUrl:e.result.backgroundRemovedUrl}):null===(s=this.successHandler)||void 0===s||s.call(this,{imageGenerateOrder:e.imageGenerateOrder,imageUrl:null!==(n=e.result.url)&&void 0!==n?n:""})}),0)},me=function(e){this.taskResultList[e.imageGenerateOrder]=e,setTimeout((()=>{var t;null===(t=this.errorHandler)||void 0===t||t.call(this,{imageGenerateOrder:e.imageGenerateOrder,error:"unknown"})}),0)};const Le=/\[(\d+)\]/;var Ie,Ee,Oe,ye,Ce,_e=function(e,t,i,r){if("a"===i&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?r:"a"===i?r.call(e):r?r.value:t.get(e)};class we{constructor(e){Ie.add(this),this.uuid=e.uuid,this.taskSize=e.taskSize,this.taskResultList=[],this.isCompleteLazyValidation=!1,this.isErrorLazyValidation=!1,this.credit=e.credit,this.successHandler=e.successHandler,this.errorHandler=e.errorHandler,this.deferred=e.deferred}getId(){return this.uuid}isValidateComplete(){return this.isCompleteLazyValidation}isComplete(){if(this.isErrorLazyValidation)return!0;if(0===this.taskResultList.length)return!1;for(let e=0;e<this.taskSize;e++)if(null==this.taskResultList[e])return!1;return!0}cancel(){for(let e=0;e<this.taskSize;e++)null==this.taskResultList[e]&&(this.taskResultList[e]={generateOrder:-100,result:null})}processWatch(e){var t,i,r,s;const n=e.list.find((e=>e.uuid===this.uuid));if(n){if(n.info.hasError){if(!this.isCompleteLazyValidation){const e=new Error("금지어 포함됨: [?]");return e.errorCode="PROHIBITED_WORD",null===(t=this.deferred)||void 0===t||t.reject(e),void(this.isErrorLazyValidation=!0)}this.isErrorLazyValidation=!0}if(0!==n.taskList.length){if(!this.isCompleteLazyValidation&&n.info.validated&&n.taskList.length>0){_e(this,Ie,"m",Ee).call(this,n);const e={uuid:this.uuid,taskSize:this.taskSize,credit:Object.assign(Object.assign({},this.credit),{isFreeCreditClient:(null!==(r=null===(i=this.credit)||void 0===i?void 0:i.remainFreeRequestCount)&&void 0!==r?r:0)>0})};null===(s=this.deferred)||void 0===s||s.resolve(e)}n.taskList.forEach((e=>{try{_e(this,Ie,"m",Oe).call(this,e)}catch(t){console.log(`${this.uuid} ${e.generateOrder} 처리중 오류`,e),console.error(t)}}))}}}}Ie=new WeakSet,Ee=function(e){this.isCompleteLazyValidation=!0,this.taskSize=e.taskList.length},Oe=function(e){var t,i,r;this.taskResultList[e.generateOrder]||(0===this.taskSize&&this.taskResultList.length>0&&(this.taskSize=this.taskResultList.length),(null===(t=e.result)||void 0===t?void 0:t.url)?_e(this,Ie,"m",ye).call(this,e):((null===(i=e.result)||void 0===i?void 0:i.hasError)||(null===(r=e.result)||void 0===r?void 0:r.isCancel))&&_e(this,Ie,"m",Ce).call(this,e))},ye=function(e){this.taskResultList[e.generateOrder]=e,setTimeout((()=>{var t;null===(t=this.successHandler)||void 0===t||t.call(this,{generateOrder:e.generateOrder,thumbnailUrl:e.result.thumbnail,videoUrl:e.result.url,mimeType:e.result.mimeType})}),0)},Ce=function(e){this.taskResultList[e.generateOrder]=e,setTimeout((()=>{var t;null===(t=this.errorHandler)||void 0===t||t.call(this,{generateOrder:e.generateOrder,error:"unknown"})}),0)};var Te,Re,ke,Ae,Ne,Pe=i(171),Se=function(e,t,i,r){if("a"===i&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?r:"a"===i?r.call(e):r?r.value:t.get(e)};class Ge{constructor(e){Te.add(this),this.uuid=e.uuid,this.taskSize=e.taskSize,this.taskResultList=[],this.isCompleteLazyValidation=!1,this.isErrorLazyValidation=!1,this.credit=e.credit,this.successHandler=e.successHandler,this.errorHandler=e.errorHandler,this.deferred=e.deferred}getId(){return this.uuid}isValidateComplete(){return this.isCompleteLazyValidation}isComplete(){if(this.isErrorLazyValidation)return!0;if(0===this.taskResultList.length)return!1;for(let e=0;e<this.taskSize;e++)if(null==this.taskResultList[e])return!1;return!0}cancel(){for(let e=0;e<this.taskSize;e++)null==this.taskResultList[e]&&(this.taskResultList[e]={generateOrder:-100,result:null})}processWatch(e){var t,i,r,s;const n=e.list.find((e=>e.uuid===this.uuid));if(n){if(n.info.hasError){if(!this.isCompleteLazyValidation){const e=new Error("금지어 포함됨: [?]");return e.errorCode="PROHIBITED_WORD",null===(t=this.deferred)||void 0===t||t.reject(e),void(this.isErrorLazyValidation=!0)}this.isErrorLazyValidation=!0}if(0!==n.taskList.length){if(!this.isCompleteLazyValidation&&n.info.validated&&n.taskList.length>0){Se(this,Te,"m",Re).call(this,n);const e={uuid:this.uuid,taskSize:this.taskSize,credit:Object.assign(Object.assign({},this.credit),{isFreeCreditClient:(null!==(r=null===(i=this.credit)||void 0===i?void 0:i.remainFreeRequestCount)&&void 0!==r?r:0)>0})};null===(s=this.deferred)||void 0===s||s.resolve(e)}n.taskList.forEach((e=>{try{Se(this,Te,"m",ke).call(this,e)}catch(t){console.log(`${this.uuid} ${e.generateOrder} 처리중 오류`,e),console.error(t)}}))}}}}Te=new WeakSet,Re=function(e){this.isCompleteLazyValidation=!0,this.taskSize=e.taskList.length},ke=function(e){var t,i,r;this.taskResultList[e.generateOrder]||(0===this.taskSize&&this.taskResultList.length>0&&(this.taskSize=this.taskResultList.length),(null===(t=e.result)||void 0===t?void 0:t.url)?Se(this,Te,"m",Ae).call(this,e):((null===(i=e.result)||void 0===i?void 0:i.hasError)||(null===(r=e.result)||void 0===r?void 0:r.isCancel))&&Se(this,Te,"m",Ne).call(this,e))},Ae=function(e){this.taskResultList[e.generateOrder]=e,setTimeout((()=>{var t;null===(t=this.successHandler)||void 0===t||t.call(this,{generateOrder:e.generateOrder,thumbnailUrl:e.result.thumbnail,videoUrl:e.result.url,mimeType:e.result.mimeType})}),0)},Ne=function(e){this.taskResultList[e.generateOrder]=e,setTimeout((()=>{var t;null===(t=this.errorHandler)||void 0===t||t.call(this,{generateOrder:e.generateOrder,error:"unknown"})}),0)};var be,Ue,De,Me,Ve,je,ze=function(e,t,i,r,s){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?s.call(e,i):s?s.value=i:t.set(e,i),i},Fe=function(e,t,i,r){if("a"===i&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?r:"a"===i?r.call(e):r?r.value:t.get(e)};class Ke{constructor(e){be.add(this),Ue.set(this,void 0),De.set(this,void 0),Me.set(this,void 0),this.uuid=e.uuid,this.credit=e.credit,ze(this,Ue,e.successHandler,"f"),ze(this,De,e.errorHandler,"f"),ze(this,Me,e.deferred,"f")}cancel(){throw new Error("Method not implemented.")}getId(){return this.uuid}isComplete(){return null!=this.taskResult&&null!=this.taskResult.result}isValidateComplete(){return!0}processWatch(e){var t,i,r,n;const a=e.list.find((e=>e.uuid===this.uuid));if(a){if(null==this.taskResult){this.taskResult={result:void 0};const e={uuid:this.uuid,credit:Object.assign(Object.assign({},this.credit),{isFreeCreditClient:(null!==(i=null===(t=this.credit)||void 0===t?void 0:t.remainFreeRequestCount)&&void 0!==i?i:0)>0})};null===(r=Fe(this,Me,"f"))||void 0===r||r.resolve(Object.assign(Object.assign({results:[e]},e),{taskSize:s.CT}))}if(null!=a.task.result&&(this.taskResult.result=a.task.result),null===(n=this.taskResult)||void 0===n?void 0:n.result){const{url:e,hasError:t,isCancel:i}=this.taskResult.result,r=s.Tn;e?Fe(this,be,"m",Ve).call(this,{imageGenerateOrder:r,uuid:this.uuid,url:e}):(t||i)&&Fe(this,be,"m",je).call(this,this.uuid,r)}}}}Ue=new WeakMap,De=new WeakMap,Me=new WeakMap,be=new WeakSet,Ve=function(e){setTimeout((()=>{var t;null===(t=Fe(this,Ue,"f"))||void 0===t||t.call(this,e)}),0)},je=function(...e){setTimeout((()=>{var t;null===(t=Fe(this,De,"f"))||void 0===t||t.call(this,...e)}),0)};var We,He,$e,qe,Be,xe,Ye,Xe,Je,Qe,Ze,et,tt,it,rt,st,nt,at,ot,lt,ut,dt,ct,ht,pt,gt,mt,ft,vt,Lt,It,Et,Ot,yt,Ct,_t,wt,Tt,Rt,kt,At,Nt,Pt,St,Gt,bt,Ut,Dt,Mt,Vt,jt,zt,Ft,Kt=function(e,t,i,r){return new(i||(i=Promise))((function(s,n){function a(e){try{l(r.next(e))}catch(e){n(e)}}function o(e){try{l(r.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,o)}l((r=r.apply(e,t||[])).next())}))},Wt=function(e,t,i,r,s){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?s.call(e,i):s?s.value=i:t.set(e,i),i},Ht=function(e,t,i,r){if("a"===i&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?r:"a"===i?r.call(e):r?r.value:t.get(e)},$t=function(e,t){var i={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(i[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(r=Object.getOwnPropertySymbols(e);s<r.length;s++)t.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(i[r[s]]=e[r[s]])}return i};const qt=null!=="v1.26.0-2025-07-15"?"v1.26.0-2025-07-15":"1",Bt="${presetCount}";console.log(`AITools @${qt} load`);const xt={"erase-area":"eraseArea","remove-bg":"removeBackground","outpaint-free":"outpaintFree"},Yt=["erase-area","image-to-image","recolor","remove-background","recommended-image","replace-background","text-to-image","upscale","inpaint","outpaint","instantid","text-to-video","image-to-video"];class Xt{constructor(e){We.add(this),$e.set(this,void 0),qe.set(this,Date.now()),Be.set(this,{presetInfoList:[],presetLang:He.defaultLangIfUndefined}),Wt(this,$e,null!=e?e:3e4,"f")}getData(){return Ht(this,Be,"f")}getLang(){var e,t;return null!==(t=null===(e=Ht(this,Be,"f"))||void 0===e?void 0:e.presetLang)&&void 0!==t?t:He.defaultLangIfUndefined}isExpired(){return Date.now()>=Ht(this,qe,"f")}update({presetInfoList:e,presetLang:t}){Wt(this,Be,{presetInfoList:Ht(this,We,"m",xe).call(this,e),presetLang:Ht(this,We,"m",Ye).call(this,t)},"f"),(null==e?void 0:e.length)&&Wt(this,qe,Date.now()+Ht(this,$e,"f"),"f")}}He=Xt,$e=new WeakMap,qe=new WeakMap,Be=new WeakMap,We=new WeakSet,xe=function(e){return[...null!=e?e:Ht(this,Be,"f").presetInfoList]},Ye=function(e){return e?a.includes(e)?e:He.fallbackLangIfUnsupported:Ht(this,Be,"f").presetLang},Xt.fallbackLangIfUnsupported=r.en,Xt.defaultLangIfUndefined=r.ko;class Jt{constructor(){if(Xe.add(this),Qe.set(this,void 0),Ze.set(this,void 0),et.set(this,void 0),tt.set(this,void 0),it.set(this,void 0),rt.set(this,void 0),st.set(this,void 0),nt.set(this,void 0),at.set(this,void 0),ot.set(this,void 0),lt.set(this,void 0),ut.set(this,void 0),dt.set(this,void 0),ct.set(this,!1),ht.set(this,[]),pt.set(this,[]),gt.set(this,new Xt),window.__MIRID.imageGenerator)try{window.__MIRID.imageGenerator.cancel()}catch(e){}Ht(this,Xe,"m",ft).call(this),Wt(this,ct,!0,"f"),Ht(this,Xe,"m",vt).call(this)}fetchPresetList(){return Kt(this,arguments,void 0,(function*(e={lang:r.ko}){Object.hasOwn(e,"lang")||(e.lang=r.ko);const t=yield this.fetchPresetListGroupByCategory(e);return Ht(this,Xe,"m",Et).call(this,t)}))}fetchPresetListFeature(){return Kt(this,arguments,void 0,(function*({lang:e=r.ko}={lang:r.ko}){const[t]=yield Promise.all([Ht(this,Xe,"m",Ot).call(this,e)]);return Ht(this,gt,"f").update({presetLang:e}),Ht(this,Xe,"m",Lt).call(this,t,e)}))}fetchPresetListGroupByCategory(){return Kt(this,arguments,void 0,(function*(e={lang:r.ko}){var t;const i=null!==(t=e.lang)&&void 0!==t?t:r.ko;let s,n=Object.assign({},Ht(Je,Je,"f",mt));const a=[];if(!0===e.preventFetchCount)s=yield Ht(this,Xe,"m",yt).call(this,i);else if(e.auth){const t=yield Promise.all([Ht(this,Xe,"m",yt).call(this,i),this.fetchCredit(e.auth)]);s=t[0],n=t[1]}else s=(yield Promise.all([Ht(this,Xe,"m",yt).call(this,i)]))[0];const o=s.categoryList.map((e=>{const t=e.presetList.map((e=>{var t,s;if(null===e.creditDeduction||void 0===e.creditDeduction){const{title:s}=null!==(t=e.presetInfoByLanguage[i])&&void 0!==t?t:e.presetInfoByLanguage[r.en];return a.push({title:s,presetKey:e.presetKey}),null}const n=null!==(s=e.presetInfoByLanguage[i])&&void 0!==s?s:e.presetInfoByLanguage[r.en],{premium:o}=n,l=$t(n,["premium"]),u=Object.assign(Object.assign({},e),{premium:o,presetInfo:l,creditDeduction:e.creditDeduction.credit});return delete u.presetInfoByLanguage,u})).filter((e=>null!==e));return Object.assign(Object.assign({},e),{presetList:t})}));return Ht(this,gt,"f").update({presetLang:i}),{disable:s.disable,categoryList:o,credit:n}}))}fetchPresetCategoryGroups(e){return Kt(this,arguments,void 0,(function*({displayType:e,lang:t,auth:i,isRawOptions:r=!1}){var s;let n,a=Object.assign({},Ht(Je,Je,"f",mt));if(i){const[r,s]=yield Promise.all([Ht(this,Xe,"m",Rt).call(this,{displayType:e,lang:t}),this.fetchCredit(i)]);n=r,a=s}else n=yield Ht(this,Xe,"m",Rt).call(this,{displayType:e,lang:t});const o=[],l={credit:a,presetCategoryGroupInfoList:(null===(s=null==n?void 0:n.presetCategoryGroupInfoList)||void 0===s?void 0:s.map((({categoryGroupKey:e,presetCategoryGroupDisplayOption:t,presetCount:i})=>{const s=null==t?void 0:t.optionMap,n={categoryGroupKey:e,presetCount:i,options:{}};if(!(0,u.Pl)(s))return o.push({categoryGroupKey:e,invalidOptionMap:s}),n;const a=[],l={};for(const[e,t]of Object.entries(s)){const r=t;void 0!==r.value?"IMAGE"!==r.type?"STRING"===r.type&&r.value.includes(Bt)?l[e]=r.value.replaceAll(Bt,`${i}`):l[e]=r.value:l[e]=r.value.url:a.push({optionKey:e,optionData:r})}if(a.length>0&&o.push({categoryGroupKey:e,invalidOptionMapItems:a}),r)return Object.assign(Object.assign({},n),{options:l});const d=function(e){const t={};for(const[i,r]of Object.entries(e)){if(!i.includes(".")){t[i]=r;continue}const e=i.split(".");let s=t;e.forEach(((t,i)=>{i===e.length-1&&(s[t]=r),void 0===s[t]&&(s[t]={});const n=s[t];(0,u.Pl)(n)&&(s=n)}))}return t}(function(e){const t={};for(const[i,r]of Object.entries(e)){const e=i.match(Le);if(null===e){t[i]=r;continue}const s=i.replace(e[0],""),n=parseInt(e[1]);if(void 0!==t[s])Array.isArray(t[s])&&(t[s][n]=r);else{const e=[];e[n]=r,t[s]=e}}return function(e){const t={};for(const[i,r]of Object.entries(e))if(Array.isArray(r)){for(let e=0;e<r.length;e++)null==r[e]&&(void 0===t[i]?t[i]=[e]:t[i].push(e));e[i]=r.filter((e=>null!=e))}return{data:e,invalidItemIndexArrays:t}}(t).data}(l));return Object.assign(Object.assign({},n),{options:d})}))).filter((({categoryGroupKey:e})=>"temporaryPresetCategoryGroupKeyForCreateDisplayType"!==e))};return o.length>0?Object.assign(Object.assign({},l),{invalidInfoList:o}):l}))}fetchPresetCategoryGroupDetails(e){return Kt(this,arguments,void 0,(function*({displayType:e,categoryGroupKey:t,lang:i,auth:r}){var s;let n,a=Object.assign({},Ht(Je,Je,"f",mt));if(r){const[s,o]=yield Promise.all([Ht(this,Xe,"m",kt).call(this,{displayType:e,lang:i,categoryGroupKey:t}),this.fetchCredit(r)]);a=o,n=s}else n=yield Ht(this,Xe,"m",kt).call(this,{displayType:e,lang:i,categoryGroupKey:t});const o=[],l={textToImage:[],imageToImage:[]},u=null===(s=null==n?void 0:n.categoryList)||void 0===s?void 0:s.map((e=>{var t,{categoryOrder:i}=e,r=$t(e,["categoryOrder"]);const s=null===(t=null==r?void 0:r.presetList)||void 0===t?void 0:t.map((({creditDeduction:e,presetInfoResponse:t,presetResponse:i})=>{if(!e)return o.push({title:t.title,presetKey:i.presetKey}),null;const{textInput:r,imageInput:s}=i.controlInfo.inputOption;"NOT_NEEDED"===r&&l.textToImage.push(i.presetKey),"NOT_NEEDED"===s&&l.imageToImage.push(i.presetKey);const n=i.sampleImageList.map((e=>({imageUrl:e}))),{premium:a}=t,u=$t(t,["premium"]);return Object.assign(Object.assign({},i),{sampleImageList:n,premium:a,presetInfo:u,creditDeduction:e.credit})})).filter((e=>null!==e));return Object.assign(Object.assign({},r),{presetList:s})}));Ht(this,gt,"f").update({presetLang:i});const d={credit:a,presetCategoryList:u,disable:l};return o.length>0?Object.assign(Object.assign({},d),{missingCreditPresetList:o}):d}))}imageToImage(e){return Kt(this,void 0,void 0,(function*(){var t;yield Ht(this,Xe,"m",Nt).call(this);const{auth:i,presetKey:r,prompt1:s,prompt2:n,image:a,imageUrl:l,imageFile:c,denoisingStrength:h,inpaintImage:p,inpaintInvert:g,aspectRatioKey:m,success:f,error:L,ip:I}=e,E=null!=a?a:c,O=null!=s?s:"",{matchedPresetInfo:y,presetLang:C,presetInfoList:_}=yield Ht(this,Xe,"m",wt).call(this,r),w=null==y?void 0:y.type;if(w&&"image-generate"!==w)switch(w){case"erase-area":return this.eraseArea({auth:i,presetKey:r,originalImageUrl:l,originalImageFile:E,success:f,error:L,maskingImageFile:p,ip:I});case"upscale":return this.upscale({auth:i,presetKey:r,imageUrl:l,success:f,error:L,imageFile:E});case"recolor":return this.recolor({auth:i,presetKey:r,imageUrl:l,success:f,error:L,imageFile:E});case"remove-bg":{const e=({url:e,imageGenerateOrder:t})=>{null==f||f({imageUrl:e,imageGenerateOrder:t})},t=(e,t)=>{null==L||L({imageGenerateOrder:t})};return this.removeBackground({auth:i,presetKey:r,imageUrl:l,success:e,error:t,imageFile:E,ip:I})}case"recommended-image":return this.recommendedImage({auth:i,presetKey:r,imageUrl:l,success:f,error:L,imageFile:E,prompt1:O});case"replace-bg":return this.replaceBackground({auth:i,presetKey:r,prompt:O,imageUrl:l,success:f,error:L,imageFile:E});case"outpaint":return this.outpaint({auth:i,presetKey:r,imageUrl:l,success:f,error:L,imageFile:E});case"inpaint":{const e=window.atob("iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII="),t=new File([Uint8Array.from(e,(e=>e.charCodeAt(0)))],"fullMaskingImage.png",{type:"image/png"});return this.inpaint({auth:i,presetKey:r,denoisingStrength:h,success:f,error:L,maskingImageFile:t,generatePromptImageFile:E,originalImageFile:E,generatePromptImageUrl:l,originalImageUrl:l})}case"instantid":return this.instantid({auth:i,presetKey:r,imageUrl:l,prompt:O,success:f,error:L,imageFile:E});case"text-to-video":{const e=e=>{null==f||f(Object.assign(Object.assign({},e),{imageUrl:e.videoUrl,imageGenerateOrder:e.generateOrder}))},t=e=>{null==L||L(Object.assign(Object.assign({},e),{imageGenerateOrder:e.generateOrder}))};return this.textToVideo({auth:i,presetKey:r,prompt:O,aspectRatioKey:m,success:e,error:t})}case"image-to-video":{const e=e=>{null==f||f(Object.assign(Object.assign({},e),{imageUrl:e.videoUrl,imageGenerateOrder:e.generateOrder}))},t=e=>{null==L||L(Object.assign(Object.assign({},e),{imageGenerateOrder:e.generateOrder}))};return this.imageToVideo({auth:i,presetKey:r,prompt:O,imageUrl:l,imageFile:E,aspectRatioKey:m,success:e,error:t})}default:throw new Error(`${w} 요청은 아직 지원하지 않습니다.\n관리자에게 문의바랍니다.`)}const T=null==y?void 0:y.inputOption;if("NOT_NEEDED"===(null==T?void 0:T.imageInput))return this.textToImage({auth:i,prompt1:O,prompt2:n,presetKey:r,success:f,error:L});if(!l&&!E)throw new oe.$W({errorCode:Pe.b.MISSING_PARAMETER,message:"imageFile or imageUrl is required"});const R=new FormData;if(R.append("presetKey",r),R.append("prompt1",O.replace(/[\r\n]/g," ")),R.append("prompt2",null!==(t=null==n?void 0:n.replace(/[\r\n]/g," "))&&void 0!==t?t:""),C&&R.append("presetLang",C),null!=m&&R.append("aspectRatioKey",m),null!=p){R.append("maskingImageFile",p);const e=g?o.INPAINT_NOT_MASKED:o.INPAINT_MASKED;R.append("inpaintingMaskInvert",e)}null!=h&&R.append("denoisingStrength",""+h);const k=null!=E?E:l;yield Ht(this,Xe,"m",Ut).call(this,{formData:R,auth:i,source:k,sourceKey:"image",ip:I,serviceType:d.y.i2i});const A=new u.cY;try{const e=yield Ht(this,Ze,"f").request(i,R);return Ht(this,pt,"f").push({uuid:e.uuid,imageGenerateType:d.y.i2i,auth:i}),Ht(this,Ze,"f").watch(new v({uuid:e.uuid,taskSize:e.taskList.length,credit:e.info.credit,successHandler:f,errorHandler:L,deferred:A})),A.promise}catch(e){if(!w){const t=(0,oe.B_)(e);yield Ht(this,Xe,"m",Ft).call(this,{error:e,traceId:t,featureType:"i2i",context:{auth:i,presetKey:r,presetInfoList:null!=_?_:null}})}throw e}}))}textToImage(e){return Kt(this,void 0,void 0,(function*(){var t,i;yield Ht(this,Xe,"m",Nt).call(this);const{prompt1:r,prompt2:s,presetKey:n,auth:a,aspectRatioKey:o,success:l,error:c}=e,h=null!=r?r:"",{matchedPresetInfo:p,presetLang:g,presetInfoList:m}=yield Ht(this,Xe,"m",wt).call(this,n),f=null==p?void 0:p.type;if(f&&"image-generate"!==f){if("text-to-video"===f){const e=e=>{null==l||l(Object.assign(Object.assign({},e),{imageUrl:e.videoUrl,imageGenerateOrder:e.generateOrder}))},t=e=>{null==c||c(Object.assign(Object.assign({},e),{imageGenerateOrder:e.generateOrder}))};return this.textToVideo({auth:a,presetKey:n,prompt:h,aspectRatioKey:o,success:e,error:t})}throw new Error(`${f} 요청은 아직 지원하지 않습니다.\n관리자에게 문의바랍니다.`)}const L={prompt1:null!==(t=null==r?void 0:r.replace(/[\r\n]/g," "))&&void 0!==t?t:"",prompt2:null!==(i=null==s?void 0:s.replace(/[\r\n]/g," "))&&void 0!==i?i:"",presetKey:n,aspectRatioKey:o,presetLang:g},I=new u.cY;return Ht(this,Qe,"f").request(a,L).then((e=>{Ht(this,pt,"f").push({uuid:e.uuid,imageGenerateType:d.y.t2i,auth:a}),Ht(this,Qe,"f").watch(new v({uuid:e.uuid,taskSize:e.taskList.length,credit:e.info.credit,successHandler:l,errorHandler:c,deferred:I}))})).catch((e=>{I.reject(e)})),I.promise}))}eraseArea(e){return Kt(this,void 0,void 0,(function*(){yield Ht(this,Xe,"m",Nt).call(this);const{auth:t,presetKey:i,originalImageUrl:r,originalImageFile:s,maskingImageUrl:n,maskingImageFile:a,ip:o,success:l,error:c}=e,h=Ht(this,gt,"f").getLang();if(!r&&!s)throw new oe.$W({errorCode:Pe.b.MISSING_PARAMETER,message:"originalImageFile or originalImageUrl is required"});if(!n&&!a)throw new oe.$W({errorCode:Pe.b.MISSING_PARAMETER,message:"maskingImageFile or maskingImageUrl is required"});const p=new FormData;h&&p.append("presetLang",h),p.append("presetKey",null!=i?i:"eraseArea");const g=null!=s?s:r;yield Ht(this,Xe,"m",Ut).call(this,{formData:p,auth:t,source:g,sourceKey:"originalImage",ip:o,serviceType:d.y["erase-area"]});const m=null!=a?a:n;yield Ht(this,Xe,"m",Ut).call(this,{formData:p,auth:t,source:m,sourceKey:"maskingImage",ip:o,serviceType:d.y["erase-area"]});const f=new u.cY,v=yield Ht(this,et,"f").request(t,p);return Ht(this,et,"f").watch(new y({uuid:v.uuid,credit:v.info.credit,successHandler:l,errorHandler:c,deferred:f})),f.promise}))}upscale(e){return Kt(this,void 0,void 0,(function*(){yield Ht(this,Xe,"m",Nt).call(this);const{presetKey:t,imageFile:i,imageUrl:r}=e,s=Ht(this,gt,"f").getLang(),n=new FormData;if(n.append("presetKey",null!=t?t:"upscale"),s&&n.append("presetLang",s),r)n.append("imageUrl",r);else{if(!i)throw new Error("imageFile or imageUrl is required");n.append("imageFile",i)}const a=yield Ht(this,tt,"f").request(e.auth,n),o=new u.cY;return Ht(this,tt,"f").watch(new R({uuid:a.uuid,credit:a.info.credit,successHandler:e.success,errorHandler:e.error,deferred:o})),o.promise}))}recolor(e){return Kt(this,void 0,void 0,(function*(){yield Ht(this,Xe,"m",Nt).call(this);const{presetKey:t,imageUrl:i,imageFile:r}=e,s=Ht(this,gt,"f").getLang();if(!i&&!r)throw new Error("imageFile or imageUrl is required");const n=new FormData;if(n.append("presetKey",null!=t?t:"recolor"),s&&n.append("presetLang",s),i)n.append("imageUrl",i);else if(r)if(r instanceof File)n.append("imageFile",r);else{const e=new File([r],"unknown.png",{type:"image/png"});n.append("imageFile",e)}const a=yield Ht(this,it,"f").request(e.auth,n),o=new u.cY;return Ht(this,it,"f").watch(new S({uuid:a.uuid,credit:a.info.credit,successHandler:e.success,errorHandler:e.error,deferred:o})),o.promise}))}removeBackground(e){return Kt(this,void 0,void 0,(function*(){yield Ht(this,Xe,"m",Nt).call(this);const{presetKey:t,imageFile:i,imageUrl:r,auth:s,ip:n,success:a,error:o}=Ht(this,Xe,"m",zt).call(this,e),l=Ht(this,gt,"f").getLang();if(!r&&!i)throw new oe.$W({errorCode:Pe.b.MISSING_PARAMETER,message:"imageFile or imageUrl is required"});const c=new FormData;c.append("presetKey",null!=t?t:"removeBackground"),l&&c.append("presetLang",l);const h=null!=i?i:r;yield Ht(this,Xe,"m",Ut).call(this,{formData:c,auth:s,source:h,sourceKey:"originalImage",ip:n,serviceType:d.y["remove-bg"]});const p=new u.cY,g=yield Ht(this,rt,"f").request(s,c);return Ht(this,rt,"f").watch(new Ke({uuid:g.uuid,credit:g.info.credit,successHandler:a,errorHandler:o,deferred:p})),p.promise}))}recommendedImage(e){return Kt(this,void 0,void 0,(function*(){var t;yield Ht(this,Xe,"m",Nt).call(this);const{presetKey:i,imageUrl:r,imageFile:s,prompt1:n}=e,a=Ht(this,gt,"f").getLang();if(!r&&!s)throw new Error("imageFile or imageUrl is required");const o=new FormData,l=new u.cY;if(o.append("presetKey",null!=i?i:"recommendedImage"),o.append("prompt1",null!==(t=null==n?void 0:n.replace(/[\r\n]/g," "))&&void 0!==t?t:""),a&&o.append("presetLang",a),r)o.append("imageUrl",r);else if(s)if(s instanceof File)o.append("imageFile",s);else{const e=new File([s],"unknown.png",{type:"image/png"});o.append("imageFile",e)}return Ht(this,st,"f").request(e.auth,o).then((t=>{Ht(this,st,"f").watch(new j({uuid:t.uuid,taskSize:t.taskList.length,credit:t.info.credit,successHandler:e.success,errorHandler:e.error,deferred:l}))})).catch((e=>{l.reject(e)})),l.promise}))}inpaint(e){return Kt(this,void 0,void 0,(function*(){var t;yield Ht(this,Xe,"m",Nt).call(this);const{auth:i,presetKey:r,prompt1:s,denoisingStrength:n,originalImageUrl:a,originalImageFile:l,maskingImageUrl:d,maskingImageFile:c,generatePromptImageUrl:h,generatePromptImageFile:p}=e,g=Ht(this,gt,"f").getLang(),m="string"==typeof a&&a.length>0,f="string"==typeof d&&d.length>0,v=l instanceof File,L=c instanceof File;if(n&&(n<=0||n>1))throw new Error("denoisingStrength must be greater than 0 and less than or equal to 1");if(!m&&!v)throw new Error("originalImageFile or originalImageUrl is required");if(!f&&!L)throw new Error("maskingImageFile or maskingImageUrl is required");const I=new FormData;if(v&&I.append("imageFile",l),L&&I.append("maskingImageFile",c),g&&I.append("presetLang",g),I.append("imageUrl",null!=a?a:""),I.append("maskingImageUrl",null!=d?d:""),I.append("denoisingStrength",String(null!=n?n:.7)),I.append("prompt1",null!==(t=null==s?void 0:s.replace(/[\r\n]/g," "))&&void 0!==t?t:""),I.append("presetKey",null!=r?r:"inpaint"),p)if(p instanceof File)I.append("generatePromptImageFile",p);else{const e=new File([p],"unknown.png",{type:"image/png"});I.append("generatePromptImageFile",e)}else h&&I.append("generatePromptImageUrl",h);const E=e.inpaintInvert?o.INPAINT_NOT_MASKED:o.INPAINT_MASKED;I.append("inpaintingMaskInvert",E);const O=new u.cY;return Ht(this,nt,"f").request(i,I).then((t=>{Ht(this,nt,"f").watch(new q({uuid:t.uuid,taskSize:t.taskList.length,credit:t.info.credit,successHandler:e.success,errorHandler:e.error,deferred:O}))})).catch((e=>{O.reject(e)})),O.promise}))}replaceBackground(e){return Kt(this,void 0,void 0,(function*(){var t;yield Ht(this,Xe,"m",Nt).call(this);const{presetKey:i,imageUrl:r,imageFile:s,prompt:n}=e,a=Ht(this,gt,"f").getLang(),o=s instanceof Blob;if(!r&&!o)throw new Error("imageFile or imageUrl is required");if(!n)throw new Error("prompt is required");const l=new FormData,d=new u.cY;if(l.append("presetKey",null!=i?i:"replaceBackground"),l.append("prompt",null!==(t=null==n?void 0:n.replace(/[\r\n]/g," "))&&void 0!==t?t:""),a&&l.append("presetLang",a),r&&l.append("imageUrl",r),o)if(s instanceof File)l.append("imageFile",s);else{const e=new File([s],"unknown.png",{type:"image/png"});l.append("imageFile",e)}return Ht(this,at,"f").request(e.auth,l).then((t=>{Ht(this,at,"f").watch(new Z({uuid:t.uuid,taskSize:t.taskList.length,credit:t.info.credit,successHandler:e.success,errorHandler:e.error,deferred:d}))})).catch((e=>{d.reject(e)})),d.promise}))}outpaint(e){return Kt(this,void 0,void 0,(function*(){yield Ht(this,Xe,"m",Nt).call(this);const{imageUrl:t,imageFile:i,top:r,bottom:s,left:n,right:a,presetKey:o,success:l,error:d}=e,c=Ht(this,gt,"f").getLang(),h=i instanceof Blob;if(!t&&!i)throw new Error("이미지 파일 또는 url을 입력해주세요.");const p=new FormData;if(o)p.append("presetKey",o);else{const e=void 0===r||void 0===a||void 0===s||void 0===n,o=0===r&&0===a&&0===s&&0===n;if(e)throw new oe.$W({message:`상, 하, 좌, 우 확장할 값을 모두 입력해주세요. 현재 입력: top: ${r}, right: ${a}, bottom: ${s}, left: ${n}`,errorCode:"MISSING_PARAMETER"});if(o)throw new oe.$W({message:`상, 하, 좌, 우 확장할 값 중 하나는 0보다 커야합니다. 현재 입력: top: ${r}, right: ${a}, bottom: ${s}, left: ${n}`,errorCode:"INVALID_PARAMETER"});try{const{width:e,height:o}=yield(e=>le(void 0,[e],void 0,(function*({file:e,url:t=""}){if(!e&&!t)throw new Error("이미지 파일 또는 url 을 입력해주세요.");try{const i=yield(e=>le(void 0,void 0,void 0,(function*(){return new Promise(((t,i)=>{const r=new Image;r.onload=()=>{t(r)},r.onerror=()=>{i(new Error)},e instanceof Blob?r.src=URL.createObjectURL(e):r.src=e}))})))(null!=e?e:t),{width:r,height:s,src:n}=i;return{width:r,height:s,src:n,filename:e instanceof File?e.name:void 0}}catch(i){if(i instanceof Error)throw new oe.$W({errorCode:"IMAGE_LOAD_FAILED",message:`이미지 ${e?"파일":"URL"} 로드에 실패했습니다.`,source:null!=e?e:t});throw i}})))({file:i,url:t});((e,t,i)=>{const{resizedWidth:r,resizedHeight:s}=((e,t,i)=>{const r=e>t,s=i/(r?e:t);return{resizedWidth:r?i:Math.round(e*s),resizedHeight:r?Math.round(t*s):i,resizeRatio:s}})(e,t,1024),{top:n,right:a,bottom:o,left:l}=i,u=[Math.round(s*n/de),Math.round(r*a/de),Math.round(s*o/de),Math.round(r*l/de)],d=u.reduce(((e,t)=>e+Math.round(t)),0),[c,h,p,g]=u;if("local"==="MISSING_ENV_VAR".STATE&&console.log(`[서버 실제 확장 값] \n                상: ${c}, \n                하: ${p}, \n                좌: ${g}, \n                우: ${h}, \n                총합: ${d}`),d>3e3)throw new oe.$W({message:`이미지 확장 시 상, 하, 좌, 우 합하여 3000px까지 가능합니다. 들어온 값들 : 상: ${c}, 하: ${p}, 좌: ${g}, 우: ${h}, 총합: ${d}`,errorCode:"EXPANSION_LIMIT_EXCEEDED"})})(e,o,{top:r,left:n,right:a,bottom:s}),p.append("presetKey",ue),p.append("top",`${Math.round(o*r/de)}px`),p.append("right",`${Math.round(e*a/de)}px`),p.append("bottom",`${Math.round(o*s/de)}px`),p.append("left",`${Math.round(e*n/de)}px`)}catch(t){if(t instanceof Error){if(!(t instanceof oe.$W&&"IMAGE_LOAD_FAILED"===t.errorCode)||e)throw t;p.append("presetKey",ue),p.append("top",`${Math.round(r)}%`),p.append("right",`${Math.round(a)}%`),p.append("bottom",`${Math.round(s)}%`),p.append("left",`${Math.round(n)}%`)}}}if(c&&p.append("presetLang",c),h)if(i instanceof File)p.append("imageFile",i);else{const e=new File([i],"unknown.png",{type:"image/png"});p.append("imageFile",e)}else{if(!t)throw new oe.$W({message:`유효하지 않은 이미지입니다. 이미지 파일은 File 타입이어야 합니다. 입력: ${i}`,errorCode:"INVALID_PARAMETER",source:i});p.append("imageUrl",t)}const g=yield Ht(this,ot,"f").request(e.auth,p),m=new u.cY;return Ht(this,ot,"f").watch(new ae({uuid:g.uuid,credit:g.info.credit,successHandler:l,errorHandler:d,taskSize:g.taskList.length,deferred:m})),m.promise}))}instantid(e){return Kt(this,void 0,void 0,(function*(){var t;yield Ht(this,Xe,"m",Nt).call(this);const{presetKey:i,imageUrl:r,imageFile:s,prompt:n,auth:a,success:o,error:l}=e,d=Ht(this,gt,"f").getLang(),c=s instanceof Blob;if(!r&&!s)throw new oe.$W({message:"이미지 파일 또는 url을 입력해주세요.",errorCode:"MISSING_PARAMETER"});const h=new FormData;if(h.append("presetKey",null!=i?i:"instantid"),h.append("prompt",null!==(t=null==n?void 0:n.replace(/[\r\n]/g," "))&&void 0!==t?t:""),d&&h.append("presetLang",d),c)if(s instanceof File)h.append("imageFile",s);else{const e=new File([s],"unknown.png",{type:"image/png"});h.append("imageFile",e)}else{if(!r)throw new oe.$W({message:`유효하지 않은 이미지입니다. 이미지 파일은 File 타입이어야 합니다. 입력: ${s}`,errorCode:"INVALID_PARAMETER",source:s});h.append("imageUrl",r)}const p=yield Ht(this,lt,"f").request(a,h),g=new u.cY;return Ht(this,lt,"f").watch(new ve({uuid:p.uuid,credit:p.info.credit,successHandler:o,errorHandler:l,taskSize:p.taskList.length,deferred:g})),g.promise}))}textToVideo(e){return Kt(this,void 0,void 0,(function*(){var t;yield Ht(this,Xe,"m",Nt).call(this);const{auth:i,prompt:r,presetKey:s,aspectRatioKey:n,success:a,error:o}=e,l=Ht(this,gt,"f").getLang();if(!s)throw new oe.$W({message:"presetKey을 입력해주세요.",errorCode:"MISSING_PARAMETER"});const c={presetKey:s,aspectRatioKey:n,prompt:null!==(t=null==r?void 0:r.replace(/[\r\n]/g," "))&&void 0!==t?t:"",presetLang:l},h=new u.cY;return Ht(this,ut,"f").request(e.auth,c).then((e=>{Ht(this,pt,"f").push({uuid:e.uuid,imageGenerateType:d.y["text-to-video"],auth:i}),Ht(this,ut,"f").watch(new we({uuid:e.uuid,taskSize:e.taskList.length,credit:e.info.credit,successHandler:a,errorHandler:o,deferred:h}))})).catch((e=>{h.reject(e)})),h.promise}))}imageToVideo(e){return Kt(this,void 0,void 0,(function*(){var t;yield Ht(this,Xe,"m",Nt).call(this);const{auth:i,presetKey:r,imageFile:s,imageUrl:n,prompt:a,aspectRatioKey:o,success:l,error:c}=e,h=Ht(this,gt,"f").getLang(),p=s instanceof Blob;if(!r)throw new oe.$W({message:"presetKey을 입력해주세요.",errorCode:"MISSING_PARAMETER"});if(!n&&!s)throw new oe.$W({message:"이미지 파일 또는 url을 입력해주세요.",errorCode:"MISSING_PARAMETER"});const g=new FormData;if(g.append("presetKey",r),g.append("prompt",null!==(t=null==a?void 0:a.replace(/[\r\n]/g," "))&&void 0!==t?t:""),h&&g.append("presetLang",h),p)if(s instanceof File)g.append("imageFile",s);else{const e=new File([s],"unknown.png",{type:"image/png"});g.append("imageFile",e)}else{if(!n)throw new oe.$W({message:`유효하지 않은 이미지입니다. 이미지 파일은 File 타입이어야 합니다. 입력: ${s}`,errorCode:"INVALID_PARAMETER",source:s});g.append("imageUrl",n)}null!=o&&g.append("aspectRatioKey",o);const m=new u.cY;return Ht(this,dt,"f").request(i,g).then((e=>{Ht(this,pt,"f").push({uuid:e.uuid,imageGenerateType:d.y["image-to-video"],auth:i}),Ht(this,dt,"f").watch(new Ge({uuid:e.uuid,taskSize:e.taskList.length,credit:e.info.credit,successHandler:l,errorHandler:c,deferred:m}))})).catch((e=>{m.reject(e)})),m.promise}))}clearCredit(e){return Kt(this,void 0,void 0,(function*(){var t;const i=new URLSearchParams;i.set("auth",null!==(t=null==e?void 0:e.userId)&&void 0!==t?t:""),(null==e?void 0:e.paid)&&i.set("k",btoa(e.userId));const r=s.OW.buildFetchOptions(e,{method:"POST"}),a=yield fetch(n.q.CREDIT_CLEAR+"?"+i.toString(),r);if(!a.ok)throw new oe.$W({errorCode:Pe.b.SERVER_ERROR,message:"크레딧 초기화 중 오류가 발생했습니다."});const o=yield a.json();return Object.assign(Object.assign({},o),{isFreeCreditClient:o.remainFreeRequestCount>0})}))}sendScore(e){var t;const i=null!=e.imageUuid?Ht(this,pt,"f").find((t=>t.uuid===e.imageUuid)):Ht(this,pt,"f")[Ht(this,pt,"f").length-1];i&&Ht(this,Xe,"m",Dt).call(this,{imageGenerateType:i.imageGenerateType,imageUuid:i.uuid,imageGenerateOrder:e.imageGenerateOrder,score:null!==(t=e.score)&&void 0!==t?t:1e6,imageDisplayType:l.TASK_RESULT,auth:i.auth})}cancel(...e){return Kt(this,void 0,void 0,(function*(){try{e.length>0?yield Promise.all(e.map((e=>Ht(this,Xe,"m",Vt).call(this,e)))):yield Promise.all(Yt.map((e=>Ht(this,Xe,"m",Vt).call(this,e))))}catch(e){console.error(e)}Ht(this,Xe,"m",ft).call(this)}))}setState(e){const t=e.data.map((e=>new v({uuid:e.uuid,taskSize:0,credit:Object.assign({},Ht(Je,Je,"f",mt)),successHandler:e.success,errorHandler:e.error})));Ht(this,Qe,"f").watch(...t)}fetchCreditDeductions(e){return Kt(this,void 0,void 0,(function*(){const t={credit:void 0,deductions:{}};let i;i=e?yield Promise.all([Ht(this,Xe,"m",Tt).call(this,e),Ht(this,Xe,"m",At).call(this,e)]):yield Promise.all([Ht(this,Xe,"m",Tt).call(this,e)]);const[r,s]=i;return r.forEach((({subType:e,credit:i})=>{var r;const s=null!==(r=xt[e])&&void 0!==r?r:e;t.deductions[s]={credit:i}})),s?t.credit=s:delete t.credit,t}))}fetchCredit(e){return Kt(this,void 0,void 0,(function*(){return Ht(this,Xe,"m",At).call(this,e)}))}}Je=Jt,Qe=new WeakMap,Ze=new WeakMap,et=new WeakMap,tt=new WeakMap,it=new WeakMap,rt=new WeakMap,st=new WeakMap,nt=new WeakMap,at=new WeakMap,ot=new WeakMap,lt=new WeakMap,ut=new WeakMap,dt=new WeakMap,ct=new WeakMap,ht=new WeakMap,pt=new WeakMap,gt=new WeakMap,Xe=new WeakSet,ft=function(){Wt(this,Qe,new s.OW({CLIENT_API:n.q.TEXT_TO_IMAGE,POLLING_API:n.q.TEXT_TO_IMAGE_POLLING,CANCEL_API:n.q.TEXT_TO_IMAGE_CANCEL,POLLING_BODY_KEY:"taskList",CUSTOM_POLLING_INTERVAL:500,CUSTOM_POLLING_INTERVAL_COUNT:4}),"f"),Wt(this,Ze,new s.OW({CLIENT_API:n.q.IMAGE_TO_IMAGE,POLLING_API:n.q.IMAGE_TO_IMAGE_POLLING,CANCEL_API:n.q.IMAGE_TO_IMAGE_CANCEL,POLLING_BODY_KEY:"taskList",CUSTOM_POLLING_INTERVAL:500,CUSTOM_POLLING_INTERVAL_COUNT:4}),"f"),Wt(this,et,new s.OW({CLIENT_API:n.q.ERASE_AREA,POLLING_API:n.q.ERASE_AREA_POLLING,CANCEL_API:n.q.ERASE_AREA_CANCEL,POLLING_BODY_KEY:"taskList",CUSTOM_POLLING_INTERVAL:500,CUSTOM_POLLING_INTERVAL_COUNT:20}),"f"),Wt(this,tt,new s.OW({CLIENT_API:n.q.UPSCALE,POLLING_API:n.q.UPSCALE_POLLING,CANCEL_API:n.q.UPSCALE_CANCEL,POLLING_BODY_KEY:"taskList",CUSTOM_POLLING_INTERVAL:500,CUSTOM_POLLING_INTERVAL_COUNT:20}),"f"),Wt(this,it,new s.OW({CLIENT_API:n.q.RECOLOR,POLLING_API:n.q.RECOLOR_POLLING,CANCEL_API:n.q.RECOLOR_CANCEL,POLLING_BODY_KEY:"taskList",CUSTOM_POLLING_INTERVAL:500,CUSTOM_POLLING_INTERVAL_COUNT:4}),"f"),Wt(this,rt,new s.OW({CLIENT_API:n.q.REMOVE_BACKGROUND,POLLING_API:n.q.REMOVE_BACKGROUND_POLLING,CANCEL_API:n.q.REMOVE_BACKGROUND_CANCEL,POLLING_BODY_KEY:"taskList",CUSTOM_POLLING_INTERVAL:500,CUSTOM_POLLING_INTERVAL_COUNT:20}),"f"),Wt(this,st,new s.OW({CLIENT_API:n.q.RECOMMENDED_IMAGE,POLLING_API:n.q.RECOMMENDED_IMAGE_POLLING,CANCEL_API:n.q.RECOMMENDED_IMAGE_CANCEL,POLLING_BODY_KEY:"taskList",CUSTOM_POLLING_INTERVAL:500,CUSTOM_POLLING_INTERVAL_COUNT:4}),"f"),Wt(this,nt,new s.OW({CLIENT_API:n.q.INPAINT,POLLING_API:n.q.INPAINT_POLLING,CANCEL_API:n.q.INPAINT_CANCEL,POLLING_BODY_KEY:"taskList",CUSTOM_POLLING_INTERVAL:500,CUSTOM_POLLING_INTERVAL_COUNT:4}),"f"),Wt(this,at,new s.OW({CLIENT_API:n.q.REPLACE_BACKGROUND,POLLING_API:n.q.REPLACE_BACKGROUND_POLLING,CANCEL_API:n.q.REPLACE_BACKGROUND_CANCEL,POLLING_BODY_KEY:"taskList",CUSTOM_POLLING_INTERVAL:500,CUSTOM_POLLING_INTERVAL_COUNT:20}),"f"),Wt(this,ot,new s.OW({CLIENT_API:n.q.OUTPAINT,POLLING_API:n.q.OUTPAINT_POLLING,CANCEL_API:n.q.OUTPAINT_CANCEL,POLLING_BODY_KEY:"taskList",CUSTOM_POLLING_INTERVAL:500,CUSTOM_POLLING_INTERVAL_COUNT:4}),"f"),Wt(this,lt,new s.OW({CLIENT_API:n.q.INSTANTID,POLLING_API:n.q.INSTANTID_POLLING,CANCEL_API:n.q.INSTANTID_CANCEL,POLLING_BODY_KEY:"taskList",CUSTOM_POLLING_INTERVAL:500,CUSTOM_POLLING_INTERVAL_COUNT:4}),"f"),Wt(this,ut,new s.OW({CLIENT_API:n.q.TEXT_TO_VIDEO,POLLING_API:n.q.TEXT_TO_VIDEO_POLLING,CANCEL_API:n.q.TEXT_TO_VIDEO_CANCEL,POLLING_BODY_KEY:"taskList",CUSTOM_POLLING_INTERVAL:500,CUSTOM_POLLING_INTERVAL_COUNT:4}),"f"),Wt(this,dt,new s.OW({CLIENT_API:n.q.IMAGE_TO_VIDEO,POLLING_API:n.q.IMAGE_TO_VIDEO_POLLING,CANCEL_API:n.q.IMAGE_TO_VIDEO_CANCEL,POLLING_BODY_KEY:"taskList",CUSTOM_POLLING_INTERVAL:500,CUSTOM_POLLING_INTERVAL_COUNT:4}),"f")},vt=function(){Ht(this,ht,"f").forEach((e=>e.resolve())),Wt(this,ht,[],"f")},Lt=function(e,t){const i=e.presetList.map((e=>{var i,s,n;const a=null!=t?t:r.ko,o=null!==(i=e.presetInfoByLanguage[a])&&void 0!==i?i:e.presetInfoByLanguage[r.en],{premium:l}=o,u=$t(o,["premium"]);return{presetKey:e.presetKey,premium:l,presetOrder:e.presetOrder,presetInfo:u,creditDeduction:null!=e.creditDeduction?e.creditDeduction.credit:0,exampleImageList:null!==(n=null===(s=e.sampleImageList)||void 0===s?void 0:s.map((e=>({volumePath:e.imageUrl}))))&&void 0!==n?n:[],controlInfo:e.controlInfo,type:e.type}}));return{textToImage:Ht(this,Xe,"m",It).call(this,i),imageToImage:Ht(this,Xe,"m",It).call(this,i),disable:e.disable}},It=function(e){const t=[];return e.forEach((e=>{var i;let r="분류 없음";(null===(i=e.presetInfo)||void 0===i?void 0:i.category)&&""!==e.presetInfo.category.name&&(r=e.presetInfo.category.name);const s=t[t.length-1];s&&s.category===r?s.list.push(e):t.push({category:r,list:[e]})})),t},Et=function(e){const{disable:t,categoryList:i}=e,r=[],s=[];return i.forEach((e=>{const t=e.presetList.map((e=>{const{presetInfo:t,creditDeduction:i,presetOrder:r,presetKey:s,sampleImageList:n,controlInfo:a,type:o,premium:l}=e;return{presetInfo:t,creditDeduction:i,premium:l,presetOrder:r,presetKey:s,controlInfo:a,exampleImageList:n.map((e=>({volumePath:e.imageUrl}))),type:o}})),i=e.presetList.map((e=>{const{presetInfo:t,creditDeduction:i,presetOrder:r,presetKey:s,sampleImageList:n,controlInfo:a,type:o,premium:l}=e;return{presetInfo:t,creditDeduction:i,premium:l,presetOrder:r,presetKey:s,controlInfo:a,exampleImageList:n.map((e=>({volumePath:e.imageUrl}))),type:o}}));r.push({category:e.name,list:t}),s.push({category:e.name,list:i})})),{textToImage:r,imageToImage:s,disable:t}},Ot=function(e){return Kt(this,void 0,void 0,(function*(){return fetch(n.q.PRESETS+"?lang="+(null!=e?e:"ko")).then((e=>e.json()))}))},yt=function(e){return Kt(this,void 0,void 0,(function*(){return fetch(`${n.q.PRESETS_GROUPBY}?lang=${e}`).then((e=>e.json()))}))},Ct=function(e){const t=e.flatMap((({presetList:e})=>[...e])).map((({presetKey:e,type:t,controlInfo:i})=>({presetKey:e,type:t,inputOption:i.inputOption})));Ht(this,gt,"f").update({presetInfoList:t})},_t=function(){return Kt(this,arguments,void 0,(function*({needUpdate:e=!1}={}){if(Ht(this,gt,"f").isExpired()||e){const{categoryList:e}=yield this.fetchPresetListGroupByCategory({lang:Ht(this,gt,"f").getLang()});Ht(this,Xe,"m",Ct).call(this,e)}return Ht(this,gt,"f").getData()}))},wt=function(e){return Kt(this,void 0,void 0,(function*(){const{presetInfoList:t,presetLang:i}=yield Ht(this,Xe,"m",_t).call(this),r=null==t?void 0:t.find((t=>t.presetKey===e));if(r)return{matchedPresetInfo:r,presetInfoList:t,presetLang:i};const{presetInfoList:s}=yield Ht(this,Xe,"m",_t).call(this,{needUpdate:!0});return{matchedPresetInfo:null==s?void 0:s.find((t=>t.presetKey===e)),presetInfoList:s,presetLang:i}}))},Tt=function(e){return Kt(this,void 0,void 0,(function*(){return fetch(n.q.EASY_EDIT_CREDIT_DEDUCTIONS).then((e=>e.json()))}))},Rt=function(e){return Kt(this,arguments,void 0,(function*({displayType:e,lang:t=r.ko}){return fetch(`${n.q.PRESETS_CATEGORY_GROUPS}?display_type=${e}&lang=${t}`).then((e=>e.json()))}))},kt=function(e){return Kt(this,arguments,void 0,(function*({categoryGroupKey:e,displayType:t,lang:i=r.ko}){return fetch(`${n.q.PRESETS_CATEGORY_GROUPS_DETAILS}?category_group_key=${e}&display_type=${t}&lang=${i}`).then((e=>e.json()))}))},At=function(e){return Kt(this,void 0,void 0,(function*(){var t;if(null==e?void 0:e.token){const t=s.OW.buildFetchOptions(e,{headers:{Authorization:e.token.startsWith("Bearer ")?e.token:`Bearer ${e.token}`}}),i=yield fetch(n.q.CREDIT_STATUS,t);if(!i.ok)throw new oe.$W({errorCode:Pe.b.SERVER_ERROR,message:"크레딧 정보를 가져오는 중 오류가 발생했습니다."});const r=yield i.json();return Object.assign(Object.assign({},r),{isFreeCreditClient:r.remainFreeRequestCount>0})}const i=new URLSearchParams;i.set("auth",null!==(t=null==e?void 0:e.userId)&&void 0!==t?t:""),(null==e?void 0:e.paid)&&i.set("k",btoa(e.userId));const r=s.OW.buildFetchOptions(e),a=yield fetch(n.q.CREDIT_STATUS+"?"+i.toString(),r);if(!a.ok)throw new oe.$W({errorCode:Pe.b.SERVER_ERROR,message:"크레딧 정보를 가져오는 중 오류가 발생했습니다."});const o=yield a.json();return Object.assign(Object.assign({},o),{isFreeCreditClient:o.remainFreeRequestCount>0})}))},Nt=function(){return Kt(this,void 0,void 0,(function*(){if(Ht(this,ct,"f"))return;const e=new u.cY;return Ht(this,ht,"f").push(e),e.promise}))},Pt=function(e){return Kt(this,void 0,void 0,(function*(){const t=yield fetch(e);if(!t.ok)throw new oe.$W({errorCode:Pe.b.INVALID_FILE,message:"파일 형식이 올바르지 않습니다. 파일을 확인하고 다시 시도해주세요.",source:e});const i=yield t.blob(),r=i.type;if(["application/json","text/","application/xml","application/pdf"].some((e=>r.startsWith(e))))throw new oe.$W({errorCode:Pe.b.INVALID_FILE,message:"파일 형식이 올바르지 않습니다. 파일을 확인하고 다시 시도해주세요.",source:e});return i}))},St=function(e){return Kt(this,arguments,void 0,(function*({source:e,serviceType:t,auth:i,mediaType:r="image/png",sourceName:s="temp.png",ip:a}){if(!i)throw new oe.$W({errorCode:Pe.b.INVALID_AUTH,message:"인증 정보가 존재하지 않습니다."});const o={source:"",name:s,type:r};if("string"==typeof e)o.source=e;else{if(!(e instanceof Blob))throw new oe.$W({errorCode:Pe.b.INVALID_FILE,message:"파일 형식이 올바르지 않습니다. 파일을 확인하고 다시 시도해주세요.",source:e});const t=e instanceof File?e:new File([e],o.name,{type:o.type});o.source=t,o.name=t.name,o.type=t.type}const l=Ht(this,Xe,"m",Mt).call(this,t);if(!l)throw new oe.$W({errorCode:Pe.b.INVALID_SERVICE_TYPE,message:`${t}은 요청할 수 없는 서비스 입니다.`});const u={serviceType:t,auth:i,filename:o.name,mediaType:o.type},{accessUrl:d,filename:c,uploadUrl:h}=yield l.enhancedRequest(n.q.PRESIGNED_URL,u,{method:"POST",headers:Object.assign({"Content-Type":"application/json"},a&&{"X-Test-Client-IP":a})});return yield l.enhancedRequest(h,o.source,{method:"PUT",headers:{"Content-Type":`${o.type}`,"Content-Disposition":`attachment; filename="${c}"`},body:o.source}),d}))},Gt=function e(t){return Kt(this,void 0,void 0,(function*(){const{source:i,auth:r,ip:s,serviceType:n}=t;try{if("string"==typeof i){const r=yield Ht(this,Xe,"m",Pt).call(this,i);return Ht(this,Xe,"m",e).call(this,Object.assign(Object.assign({},t),{source:r}))}return yield Ht(this,Xe,"m",St).call(this,{serviceType:n,source:i,auth:r,ip:s})}catch(e){if((0,Pe.n)(e))throw e;throw new oe.$W({errorCode:Pe.b.SERVER_ERROR,message:`알 수 없는 에러 발생, ${e.message}`,source:i})}}))},bt=function(e,t="unknown.png",i="image/png"){const r=e instanceof Blob,s=e instanceof File;if(!r)throw new oe.$W({errorCode:Pe.b.INVALID_FILE,message:`파일은 File 타입이어야 합니다. 입력: ${e}`,source:e});return s?e:new File([e],t,{type:i})},Ut=function(e){return Kt(this,arguments,void 0,(function*({formData:e,source:t,sourceKey:i,serviceType:r,ip:s,auth:n}){const a=t instanceof Blob,o="string"==typeof t;if(!a&&!o)throw new oe.$W({errorCode:Pe.b.INVALID_FILE,message:`이미지 파일은 File 또는 Blob 타입이어야 합니다. 입력: ${t}`,source:t});try{const a=yield Ht(this,Xe,"m",Gt).call(this,{auth:n,source:t,ip:s,serviceType:r});e.append(`${i}Url`,a)}catch(r){a&&e.append(`${i}File`,Ht(this,Xe,"m",bt).call(this,t)),o&&e.append(`${i}Url`,t)}}))},Dt=function(e){const{imageUuid:t,imageGenerateType:i,imageGenerateOrder:r,score:a,imageDisplayType:o,auth:l}=e,u={imageUuid:t,imageGenerateType:i,imageGenerateOrder:r,score:a,imageDisplayType:o,auth:null==l?void 0:l.userId};!0===(null==l?void 0:l.paid)&&(u.k=btoa(l.userId));const d=s.OW.buildFetchOptions(l,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)});fetch(n.q.IMAGE_GENERATED_SCORE,d).then((()=>{}))},Mt=function(e){switch(e){case"t2i":return Ht(this,Qe,"f");case"i2i":return Ht(this,Ze,"f");case"erase-area":return Ht(this,et,"f");case"upscale":return Ht(this,tt,"f");case"recolor":return Ht(this,it,"f");case"remove-bg":return Ht(this,rt,"f");case"recommended-image":return Ht(this,st,"f");case"replace-bg":return Ht(this,at,"f");case"inpaint":return Ht(this,nt,"f");case"outpaint":return Ht(this,ot,"f");case"instantid":return Ht(this,lt,"f");case"text-to-video":return Ht(this,ut,"f");case"image-to-video":return Ht(this,dt,"f");default:return}},Vt=function(e){return Kt(this,void 0,void 0,(function*(){var t,i,r,s,n,a,o,l,u,d,c,h,p;switch(e){case"text-to-image":return null===(t=Ht(this,Qe,"f"))||void 0===t?void 0:t.destroy();case"image-to-image":return null===(i=Ht(this,Ze,"f"))||void 0===i?void 0:i.destroy();case"erase-area":return null===(r=Ht(this,et,"f"))||void 0===r?void 0:r.destroy();case"upscale":return null===(s=Ht(this,tt,"f"))||void 0===s?void 0:s.destroy();case"recolor":return null===(n=Ht(this,it,"f"))||void 0===n?void 0:n.destroy();case"remove-background":return null===(a=Ht(this,rt,"f"))||void 0===a?void 0:a.destroy();case"recommended-image":return null===(o=Ht(this,st,"f"))||void 0===o?void 0:o.destroy();case"replace-background":return null===(l=Ht(this,at,"f"))||void 0===l?void 0:l.destroy();case"inpaint":return null===(u=Ht(this,nt,"f"))||void 0===u?void 0:u.destroy();case"outpaint":return null===(d=Ht(this,ot,"f"))||void 0===d?void 0:d.destroy();case"instantid":return null===(c=Ht(this,lt,"f"))||void 0===c?void 0:c.destroy();case"text-to-video":return null===(h=Ht(this,ut,"f"))||void 0===h?void 0:h.destroy();case"image-to-video":return null===(p=Ht(this,dt,"f"))||void 0===p?void 0:p.destroy();default:throw new Error("Invalid request type")}}))},jt=function(e){return Array.isArray(e.data)},zt=function(e){var t;const i="object"==typeof e.auth?e.auth:{userId:"anonymous"};return Ht(Je,Je,"m",jt).call(Je,e)?{auth:i,imageUrl:null===(t=e.data[0])||void 0===t?void 0:t.src,success:e.data[0].success,error:e.data[0].error}:Object.assign(Object.assign({},e),{auth:i})},Ft=function(e){return Kt(this,arguments,void 0,(function*({error:e,traceId:t=null,featureType:i=null,context:r=null}){const s=e instanceof Error?e.message:JSON.stringify(e),a=e instanceof Error?e.stack:null;let o;try{o=JSON.stringify(r)}catch(e){o="Unable to stringify context"}const l=`\n            ⭐️ [${null!=i?i:""}] production:${null!=t?t:""}\n            📌 Date: ${(new Date).toISOString()}\n            📌 URL: ${"undefined"!=typeof window?window.location.href:""}\n            📌 Error: ${s}\n            📌 Stack: ${a}\n            📌 Context: ${o}\n        `.replace(/\n\s+/g,"\n");try{yield fetch(n.q.ERROR_LOGS,{method:"POST",headers:{"Content-Type":"text/plain"},body:l})}catch(e){}}))},mt={value:{total:0,remainFreeRequestCount:0,remain:0,provisionInfoList:[],isFreeCreditClient:!1}},(()=>{var e;window.__MIRID=null!==(e=window.__MIRID)&&void 0!==e?e:{};const t=new Jt;window.__MIRID.imageGenerator=t,window.__MIRID.aiImage=t,window.__MIRID.AITools=t})()})();